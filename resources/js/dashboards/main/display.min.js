function displayChannelDemographics(e){const t=e.result.rows;let n=0,o=0,r=0,a=0;for(var i=0;i<t.length;i++){const e=parseFloat(t[i][2]);"female"==t[i][1]?(o+=e,e>a&&(a=e)):(n+=e,e>r&&(r=e))}for(i=0;i<t.length;i++){const e=t[i][0].substr(3),n=t[i][2];let o=document.getElementById(t[i][1]+"-"+e);o.innerHTML=`<span>${n}</span>%`,"female"==t[i][1]?o.style.opacity=(parseFloat(n)/a+1.5)/2.5:o.style.opacity=(parseFloat(n)/r+1.5)/2.5}if(n=Math.round(10*n)/10,o=Math.round(10*o)/10,n+o!=100){const e=100-(n+o);o+=e,o=Math.round(10*o)/10}document.getElementById("male-title").innerHTML=`\n    <i class="fas fa-male" style="font-size:3rem"></i>\n    <br>\n    <span style="font-size:2rem">${n}</span>\n    %\n  `,document.getElementById("female-title").innerHTML=`\n    <i class="fas fa-female" style="font-size:3rem"></i>\n    <br>\n    <span style="font-size:2rem">${o}</span>\n    %\n  `;const s=.0875,l=.05,c=s*document.documentElement.clientHeight,u=l*document.documentElement.clientWidth,d=[n,o],m=["Male","Female"],h=[{values:d,labels:m,textinfo:"none",hoverinfo:"none",marker:{colors:["rgb(84, 157, 209)","rgb(146, 111, 209)"]},type:"pie"}];let p={height:c,weight:u,showlegend:!1,margin:{l:0,r:0,t:0,b:0,pad:4}};const g={staticPlot:!0};if(gapi.auth2.getAuthInstance().isSignedIn.get()){const e=getCurrentDashboardTheme("platform");"dark"==e&&(p.plot_bgcolor="#222",p.paper_bgcolor="#222")}const b=getDashboardGraphIds("platform"),f=b.demographics;var y=document.getElementById(f);y.style.height=u+"px",y.style.width=u+"px";try{createGraph(f,h,p,g,s,l)}catch(e){return recordError(e,"Unable to display channel demographics graph"),Promise.resolve("Error Displaying Channel Demographics")}if(gapi.auth2.getAuthInstance().isSignedIn.get()){const e={values:[[JSON.stringify(t)]]};return updateSheetData("Stats","Channel Demographics",e).then(e=>"Displayed Channel Demographics")}return Promise.resolve("Displayed Channel Demographics")}function displayChannelSearchTerms(e){const t=e.result.rows;let n=[],o=[];const r=Math.min(9,t.length+-1);for(var a=r;a>=0;a--)n.push(t[a][1]),o.push(t[a][0]);var i=n.map(String);for(a=0;a<i.length;a++)i[a]=numberWithCommas(i[a]);const s=.2287,l=.4681,c=s*document.documentElement.clientHeight,u=l*document.documentElement.clientWidth,d=Math.floor(.0125*document.documentElement.clientWidth);let m={showline:!0,showticklabels:!0,tickmode:"linear",automargin:!0},h={yaxis:m};const p=[{x:n,y:o,type:"bar",orientation:"h",text:i,textposition:"auto",marker:{color:"rgb(255,0,0)"}}];let g={height:c,width:u,font:{size:d},margin:{b:10,r:0,t:10},xaxis:{visible:!1,automargin:!0},yaxis:m};const b={staticPlot:!0,responsive:!0},f=getCurrentDashboardTheme("platform");"dark"==f&&(g.plot_bgcolor="#222",g.paper_bgcolor="#222",g.font.color="#fff",m.linecolor="#fff",g.yaxis=m,h={yaxis:m});const y=getDashboardGraphIds("platform"),v=y.searchTerms;try{createGraph(v,p,g,b,s,l,!0,h)}catch(e){return displayGraphError(v,e),Promise.resolve("Error Displaying Channel Search Terms")}return Promise.resolve("Displayed Channel Search Terms")}function displayWatchTimeBySubscribedStatus(e){const t=e.result.rows,n={UNSUBSCRIBED:"Not Subscribed",SUBSCRIBED:"Subscribed"};for(var o=0,r=[],a=[],i=0;i<t.length;i++)o+=t[i][1],r.push(t[i][1]),a.push(n[t[i][0]]);var s=[];for(i=0;i<r.length;i++)s[i]=decimalToPercent(r[i]/o)+"%";r[0]>r[1]&&(r.reverse(),a.reverse(),s.reverse());const l=.1039,c=.4681,u=l*document.documentElement.clientHeight,d=c*document.documentElement.clientWidth,m=Math.floor(.0125*document.documentElement.clientWidth);let h={showline:!0,showticklabels:!0,tickmode:"linear",automargin:!0},p={yaxis:h};const g=[{x:r,y:a,type:"bar",orientation:"h",text:s,textposition:"auto",marker:{color:"rgb(255,0,0)"}}];let b={height:u,width:d,font:{size:m},margin:{r:0,t:10,b:10},xaxis:{visible:!1,automargin:!0},yaxis:h};const f={staticPlot:!0,responsive:!0},y=getCurrentDashboardTheme("platform");"dark"==y&&(b.plot_bgcolor="#222",b.paper_bgcolor="#222",b.font.color="#fff",h.linecolor="#fff",b.yaxis=h,p={yaxis:h});const v=getDashboardGraphIds("platform"),w=v.watchTime;try{createGraph(w,g,b,f,l,c,!0,p)}catch(e){return displayGraphError(w,e),Promise.resolve("Error Displaying Watch Time By Subscribed Status")}return Promise.resolve("Displayed Watch Time By Subscribed Status")}function displayViewsByDeviceType(e){let t=e.result.rows;const n=t[1];t[1]=t[3],t[3]=n;const o={DESKTOP:"Desktop",MOBILE:"Mobile",TABLET:"Tablet",TV:"TV",GAME_CONSOLE:"Game<br>Console"};let r=[],a=[];for(let e=0;e<t.length;e++)r.push(t[e][1]),a.push(o[t[e][0]]);const i=.3742,s=.3065,l=i*document.documentElement.clientHeight,c=s*document.documentElement.clientWidth,u=Math.floor(.0125*document.documentElement.clientWidth),d=Math.floor(.01*document.documentElement.clientWidth),m=[{values:r,labels:a,direction:"clockwise",hovertemplate:"<b>%{label}</b><br>%{value} views<br>%{percent} of total views<extra></extra>",rotation:-120,sort:!1,textinfo:"label+percent",textposition:["inside","outside","outside","inside","outside"],type:"pie"}];let h={height:l,width:c,automargin:!0,autosize:!0,font:{size:u},hoverlabel:{font:{size:d}},margin:{b:20,l:0,r:0,t:0,pad:4},showlegend:!1};const p={responsive:!0,staticPlot:!0},g=getCurrentDashboardTheme("platform");"dark"==g&&(h.plot_bgcolor="#222",h.paper_bgcolor="#222",h.font.color="#fff");const b=getDashboardGraphIds("platform"),f=b.deviceType;try{createGraph(f,m,h,p,i,s)}catch(e){return displayGraphError(f,e),Promise.resolve("Error Displaying Views By Device Type")}return Promise.resolve("Displayed Views By Device Type")}function displayViewsByState(e){const t=e.result.rows,n={AL:"Alabama",AK:"Alaska",AS:"American Samoa",AZ:"Arizona",AR:"Arkansas",CA:"California",CO:"Colorado",CT:"Connecticut",DE:"Delaware",DC:"District Of Columbia",FM:"Federated States Of Micronesia",FL:"Florida",GA:"Georgia",GU:"Guam",HI:"Hawaii",ID:"Idaho",IL:"Illinois",IN:"Indiana",IA:"Iowa",KS:"Kansas",KY:"Kentucky",LA:"Louisiana",ME:"Maine",MH:"Marshall Islands",MD:"Maryland",MA:"Massachusetts",MI:"Michigan",MN:"Minnesota",MS:"Mississippi",MO:"Missouri",MT:"Montana",NE:"Nebraska",NV:"Nevada",NH:"New Hampshire",NJ:"New Jersey",NM:"New Mexico",NY:"New York",NC:"North Carolina",ND:"North Dakota",MP:"Northern Mariana Islands",OH:"Ohio",OK:"Oklahoma",OR:"Oregon",PW:"Palau",PA:"Pennsylvania",PR:"Puerto Rico",RI:"Rhode Island",SC:"South Carolina",SD:"South Dakota",TN:"Tennessee",TX:"Texas",UT:"Utah",VT:"Vermont",VI:"Virgin Islands",VA:"Virginia",WA:"Washington",WV:"West Virginia",WI:"Wisconsin",WY:"Wyoming"};let o=[],r=[],a=[],i=[];for(let e=0;e<t.length;e++){let s=t[e][0].substr(3);o.push(s),r.push(n[s]),a.push(t[e][1]),i.push(numberWithCommas(t[e][1])+" views")}const s=.3742,l=.4681,c=s*document.documentElement.clientHeight,u=l*document.documentElement.clientWidth,d=Math.floor(.0093*document.documentElement.clientWidth),m=Math.floor(.01*document.documentElement.clientWidth);let h=[{autocolorscale:!0,colorbar:{tickfont:{size:d}},customdata:r,hovertemplate:"<b>%{customdata}</b><br>%{text}<extra></extra>",locationmode:"USA-states",locations:o,name:"Views By State",text:i,type:"choropleth",z:a}],p={height:c,width:u,geo:{countrycolor:"rgb(255, 255, 255)",lakecolor:"rgb(255, 255, 255)",landcolor:"rgb(217, 217, 217)",scope:"usa",showlakes:!0,showland:!0,subunitcolor:"rgb(255, 255, 255)"},hoverlabel:{font:{size:m}},margin:{b:10,l:0,r:0,t:0,pad:4}};const g={displayModeBar:!1,responsive:!0,scrollZoom:!1},b=getCurrentDashboardTheme("platform");"dark"==b&&(p.plot_bgcolor="#222",p.paper_bgcolor="#222",h[0].colorbar={tickfont:{color:"#fff"}},p.geo.bgcolor="#222",p.geo.showlakes=!1);const f=getDashboardGraphIds("platform"),y=f.states;try{createGraph(y,h,p,g,s,l)}catch(e){return displayGraphError(y,e),Promise.resolve("Error Displaying Views By State")}return Promise.resolve("Displayed Views By State")}function displayViewsByTrafficSource(e){const t=e.result.rows;let n=0,o=0,r=0,a=0,i=0;const s=["ADVERTISING","PROMOTED"],l=["EXT_URL","NO_LINK_EMBEDDED","NO_LINK_OTHER"],c=["YT_SEARCH"],u=["RELATED_VIDEO"];for(var d=0;d<t.length;d++)s.includes(t[d][0])?n+=t[d][1]:l.includes(t[d][0])?o+=t[d][1]:c.includes(t[d][0])?r+=t[d][1]:u.includes(t[d][0])?a+=t[d][1]:i+=t[d][1];const m=[n,o,r,a,i],h=["Advertising","External","YouTube<br>Search","Related<br>Video","Other"],p=.3742,g=.3065,b=p*document.documentElement.clientHeight,f=g*document.documentElement.clientWidth,y=Math.floor(.0125*document.documentElement.clientWidth),v=Math.floor(.01*document.documentElement.clientWidth),w=[{values:m,labels:h,hovertemplate:"<b>%{label}</b><br>%{value} views<br>%{percent} of total views<extra></extra>",rotation:90,textinfo:"label+percent",textposition:"inside",type:"pie"}];let E={height:b,width:f,automargin:!0,autosize:!0,font:{size:y},hoverlabel:{font:{size:v}},margin:{b:10,l:0,r:0,t:0,pad:4},showlegend:!1};const T={responsive:!0,staticPlot:!0},D=getCurrentDashboardTheme("platform");"dark"==D&&(E.plot_bgcolor="#222",E.paper_bgcolor="#222",E.font.color="#fff");const M=getDashboardGraphIds("platform"),I=M.trafficSource;try{createGraph(I,w,E,T,p,g)}catch(e){return displayGraphError(I,e),Promise.resolve("Error Displaying Views By Traffic Source")}return Promise.resolve("Displayed Views By Traffic Source")}function calcAvgVideoDuration(){let e=lsGet("statsByVideoId");if(e){let t=0,n=0;for(let o in e)e.hasOwnProperty(o)&&(n+=parseInt(e[o].duration),t++);let o=n/t,r=document.getElementById("stat-avg-duration").value,a=decimalToPercent(r/o);isNaN(a)&&(a=36.1),document.getElementById("stat-avg-percentage").innerText=a+"%"}else document.getElementById("stat-avg-percentage").innerText="36.1%"}function displayRealTimeStats(e){if(e=e||lsGet("realTimeStats"),e.cumulative&&e.month&&e.today){var t={};for(const n in e.today)e.today.hasOwnProperty(n)&&"averageViewDuration"!=n&&(t[n]=Math.round(43200/e.today[n]));lsSet("secondsPerIncrement",t);let r=new Date;r.setHours(6,0,0,0);const a=new Date,i=Math.round((a-r)/1e3);var n=document.getElementById("stat-avg-duration"),o={views:["stat-views-cumulative","stat-views-month"],estimatedMinutesWatched:["stat-minutes-cumulative","stat-minutes-month"],netSubscribersGained:["stat-subs-cumulative","stat-subs-month"],cumulative:{views:"stat-views-cumulative",estimatedMinutesWatched:"stat-minutes-cumulative",netSubscribersGained:"stat-subs-cumulative"},month:{views:"stat-views-month",estimatedMinutesWatched:"stat-minutes-month",netSubscribersGained:"stat-subs-month"}};lsSet("odometerCategories",o),["cumulative","month"].forEach(n=>{const r=o[n];for(const o in r)if(r.hasOwnProperty(o)){var a=r[o],s=document.getElementById(a),l=e[n][o];l+=Math.round(i/t[o]),s.setAttribute("value",l),s.innerHTML=l}});const s=secondsToDurationMinSec(e.cumulative.averageViewDuration);return n.innerHTML=s,n.value=e.cumulative.averageViewDuration,calcAvgVideoDuration(e.cumulative.averageViewDuration),Promise.resolve("Displayed Real Time Stats Dashboard")}}function updateRealTimeStats(e){let t=lsGet("secondsPerIncrement"),n=lsGet("odometerCategories");for(var o in t)if(t.hasOwnProperty(o)&&e%t[o]==0){var r=n[o];r.forEach(e=>{var t=document.getElementById(e),n=parseInt(t.getAttribute("value"))+1;t.innerHTML=n,t.setAttribute("value",n)})}}function displayUploadThumbnails(){let e=lsGet("statsByVideoId");var t=document.getElementsByClassName("carousel-inner")[0];if(t.children.thumbnails){let t=lsGet("uploads");if(!t){const e=new Error("Uploads does not exist");throw recordError(e),e}for(var n="",o=0;o<t.length;o++){var r="YouTube Video ID: "+t[o];e&&e[t[o]]&&(r=e[t[o]].title),n+=`\n        <a href="https://youtu.be/${t[o]}" target="_blank"\n            alt="${r}">\n          <img class="thumbnail"\n              src="https://i.ytimg.com/vi/${t[o]}/mqdefault.jpg" \n              alt="thumbnail" title="${r}">\n        </a>`}var a=document.getElementById("thumbnail-container");if(a.innerHTML=n,!autoScrollDivs.includes("thumbnail-wrapper")){let e=lsGet("settings"),t=-1,n=0;for(;-1==t&&n<=e.dashboards.length;){let o=e.dashboards[n];"thumbnails"==o.name&&(t=o.scrollSpeed),n++}t=t<=0?0:Math.ceil(1e3/t),new AutoDivScroll("thumbnail-wrapper",t,1,1),autoScrollDivs.push("thumbnail-wrapper")}}return Promise.resolve("Displayed Upload Thumbnails")}function displayTopVideoTitles(e){let t={};for(const n in e)if(e.hasOwnProperty(n)){const o=e[n],r=lsGet("statsByVideoId");let a=document.getElementById(o+"-title");a.innerHTML=r[n].title;const i=r[n].duration;document.getElementById(o+"-duration").innerHTML="Duration: "+secondsToDuration(i),document.getElementById(o+"-duration-seconds").innerHTML=i;let s=document.getElementById(o+"-publish-date"),l=r[n].publishDate;l=dateToMMDDYYYY(l),s.innerHTML="Published: "+l;let c=document.getElementById(o+"-thumbnail"),u="YouTube Video ID: "+n;r&&r[n]&&(u=r[n].title);let d=`\n        <a href="https://youtu.be/${n}" target="_blank"\n            alt="${u}">\n          <img class="top-video-thumbnail" onload="thumbnailCheck($(this), true)"\n              src="https://i.ytimg.com/vi/${n}/maxresdefault.jpg"\n              alt="thumbnail" title="${u}">\n        </a>`;c.innerHTML=d,t[n]={dashboardId:o,title:r[n].title,duration:r[n].duration,publishDate:l,thumbnail:d}}return t}function displayVideoBasicStats(e,t,n){const o=e.result.rows;for(let e=0;e<o.length;e++){const r=o[e],a=r[0],i=t[a];let s=document.getElementById(i+"-views");s.innerHTML=numberWithCommas(r[1]);let l=document.getElementById(i+"-subs-net");l.innerHTML=numberWithCommas(r[7]-r[8]);let c=document.getElementById(i+"-like-ratio"),u=document.getElementById(i+"-likes"),d=document.getElementById(i+"-like-bar");const m=decimalToPercent(r[3]/(r[3]+r[4]));c.innerHTML=m+"%",u.innerHTML=numberWithCommas(r[3])+" Likes",d.style.width=m+"%",d.setAttribute("aria-valuenow",m);let h=document.getElementById(i+"-dislikes");h.innerHTML=r[4]+" Dislikes";let p=document.getElementById(i+"-comments");p.innerHTML=numberWithCommas(r[2]);let g=document.getElementById(i+"-avg-view-duration");const b=r[6];g.innerHTML=secondsToDuration(b);const f=document.getElementById(i+"-duration-seconds").innerHTML,y=decimalToPercent(b/f);let v=document.getElementById(i+"-avg-view-percentage");v.innerHTML=" ("+y+"%)";let w=document.getElementById(i+"-minutes-watched");w.innerHTML=numberWithCommas(r[5]),null!=n&&(n[a].views=r[1],n[a].subscribersGained=r[7]-r[8],n[a].avgViewDuration=r[6],n[a].minutesWatched=r[5],n[a].comments=r[2],n[a].likes=r[3],n[a].dislikes=r[4])}return null==n?null:n}function displayVideoSearchTerms(e,t){if(e){let p=e.result.rows,g=[],b=[],f=Math.min(4,p.length-1);for(var n=f;n>=0;n--)g.push(p[n][1]),b.push(p[n][0]);var o=g.map(String);for(n=0;n<o.length;n++)o[n]=numberWithCommas(o[n]);var r=.228,a=.4681,i=r*document.documentElement.clientHeight,s=a*document.documentElement.clientWidth,l=Math.floor(.0125*document.documentElement.clientWidth),c={showline:!0,showticklabels:!0,tickmode:"linear",automargin:!0},u={yaxis:c},d=[{x:g,y:b,type:"bar",orientation:"h",text:o,textangle:0,textposition:"auto",marker:{color:"rgb(255,0,0)"}}],m={height:i,width:s,font:{size:l},autosize:!1,margin:{b:0,r:0,t:0},xaxis:{visible:!1},yaxis:c},h={staticPlot:!0,responsive:!0};const y=getCurrentDashboardTheme(t);"dark"==y&&(m.plot_bgcolor="#222",m.paper_bgcolor="#222",m.font.color="#fff",c.linecolor="#fff",m.yaxis=c,u={yaxis:c});const v=getDashboardGraphIds(t),w=v.searchTerms;try{createGraph(w,d,m,h,r,a,!0,u)}catch(e){throw displayGraphError(w),e}}}function getTopVideoByCategory(e,t,n){let o=lsGet("categoryStats"),r=lsGet("allVideoStats"),a=lsGet("statsByVideoId");r.sort(function(e,n){return parseInt(n[t])-parseInt(e[t])}),(null==n||n<=0)&&(n=1);let i=[],s=0,l=!1;for(;s<o.length&&!l;){if(o[s].categoryId==e){l=!0;let e=o[s].videos,t=0,c=0;for(;t<r.length&&c<n;){const n=r[t].videoId,o=a[n].organic;e.includes(n)&&o&&(i.push(n),c++),t++}}s++}return i}function displayVideoStrengthBars(e,t){const n=lsGet("strengthCalc"),o=n.weights;let r=[],a=[];for(const t in o)if(o.hasOwnProperty(t)){const n=o[t];0!=n&&("avgViewsPerDay"==t?r.push("Average<br>Views<br>Per Day"):"likesPerView"==t?r.push("Likes<br>Per View"):"subscribersGained"==t?r.push("Subscribers<br>Gained"):"avgViewPercentage"==t?r.push("Average<br>View<br>Percentage"):"dislikesPerView"==t?r.push("Dislikes<br>Per View"):r.push(capitalizeFirstLetter(t)),n>0?a.push(e.z[t]):a.push(-1*e.z[t]))}const i=[],s="rgb(50,171,96)",l="rgb(255,0,0)";for(let e=0;e<a.length;e++){const t=a[e];t>=0?i.push(s):i.push(l)}const c=.3673,u=.2864,d=c*document.documentElement.clientHeight,m=u*document.documentElement.clientWidth,h=Math.floor(.0114*document.documentElement.clientWidth),p=Math.floor(.0067*document.documentElement.clientWidth),g=Math.floor(.0093*document.documentElement.clientWidth),b=Math.floor(.0093*document.documentElement.clientWidth),f=h+10,y=[{x:r,y:a,marker:{color:i},type:"bar"}],v={height:d,width:m,hovermode:!1,margin:{b:0,l:0,r:0,t:f},paper_bgcolor:"rgb(255,250,250)",plot_bgcolor:"rgb(255,250,250)",title:{font:{size:h},text:"Contributions to Video Strength"},xaxis:{automargin:!0,fixedrange:!0,tickangle:0,tickfont:{size:p}},yaxis:{automargin:!0,fixedrange:!0,gridcolor:"#aaaaaa",tickprefix:" ",tickfont:{size:g},title:{font:{size:b},text:"Contribution"},zerolinewidth:2}},w={scrollZoom:!1,displayModeBar:!1,staticPlot:!0,responsive:!0};try{createGraph(t,y,v,w,c,u)}catch(e){displayGraphError(t,e)}}function sortVideosByStrength(e,t){return null==e.strength?1:null==t.strength?-1:e.strength==t.strength?t.totalStrength-e.totalStrength:t.strength-e.strength}