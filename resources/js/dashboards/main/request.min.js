function requestChannelDemographics(e,r){const t={dimensions:"ageGroup,gender",endDate:r,ids:"channel==UCR5c2ZGLZY2FFbxZuSxzzJg",metrics:"viewerPercentage",sort:"gender,ageGroup",startDate:e};return gapi.client.youtubeAnalytics.reports.query(t).then(e=>(console.log("Channel Demographics",e),displayChannelDemographics(e))).catch(e=>{const r="Error getting Channel Demographics: ";console.error(r,e),recordError(e,r)})}function requestChannelSearchTerms(e,r){const t={dimensions:"insightTrafficSourceDetail",endDate:r,filters:"insightTrafficSourceType==YT_SEARCH",ids:"channel==UCR5c2ZGLZY2FFbxZuSxzzJg",maxResults:5,metrics:"views",sort:"-views",startDate:e};return gapi.client.youtubeAnalytics.reports.query(t).then(e=>(console.log("Channel Search Terms",e),displayChannelSearchTerms(e))).catch(e=>{const r="Error getting Channel Search Terms: ";console.error(r,e),recordError(e,r);const t=getDashboardGraphIds("platform"),s=t.searchTerms;displayGraphError(s)})}function requestWatchTimeBySubscribedStatus(e,r){const t={dimensions:"subscribedStatus",endDate:r,ids:"channel==UCR5c2ZGLZY2FFbxZuSxzzJg",metrics:"estimatedMinutesWatched",startDate:e};return gapi.client.youtubeAnalytics.reports.query(t).then(e=>(console.log("Watch Time By Subscribed Status",e),displayWatchTimeBySubscribedStatus(e))).catch(e=>{const r="Error getting Watch Time By Subscribed Status: ";console.error(r,e),recordError(e,r);const t=getDashboardGraphIds("platform"),s=t.watchTime;displayGraphError(s)})}function requestViewsByDeviceType(e,r){const t={dimensions:"deviceType",endDate:r,ids:"channel==UCR5c2ZGLZY2FFbxZuSxzzJg",metrics:"views",sort:"-views",startDate:e};return gapi.client.youtubeAnalytics.reports.query(t).then(e=>(console.log("Views By Device Type",e),displayViewsByDeviceType(e))).catch(e=>{const r="Error getting Views By Device Type: ";console.error(r,e),recordError(e,r);const t=getDashboardGraphIds("platform"),s=t.deviceType;displayGraphError(s)})}function requestViewsByState(e,r){const t={dimensions:"province",endDate:r,filters:"country==US",ids:"channel==UCR5c2ZGLZY2FFbxZuSxzzJg",metrics:"views",sort:"province",startDate:e};return gapi.client.youtubeAnalytics.reports.query(t).then(e=>(console.log("Views By State",e),displayViewsByState(e))).catch(e=>{const r="Error getting Views By State: ";console.error(r,e),recordError(e,r);const t=getDashboardGraphIds("platform"),s=t.states;displayGraphError(s)})}function requestViewsByTrafficSource(e,r){const t={dimensions:"insightTrafficSourceType",endDate:r,ids:"channel==UCR5c2ZGLZY2FFbxZuSxzzJg",metrics:"views",sort:"-views",startDate:e};return gapi.client.youtubeAnalytics.reports.query(t).then(e=>(console.log("Views By Traffic Source",e),displayViewsByTrafficSource(e))).catch(e=>{const r="Error getting Views By Traffic Source: ";console.error(r,e),recordError(e,r);const t=getDashboardGraphIds("platform"),s=t.trafficSource;displayGraphError(s)})}function requestRealTimeStats(e,r){const t={endDate:r,ids:"channel==UCR5c2ZGLZY2FFbxZuSxzzJg",metrics:"views,subscribersGained,subscribersLost,estimatedMinutesWatched,averageViewDuration",startDate:e};return gapi.client.youtubeAnalytics.reports.query(t).then(e=>{console.log("Real Time Stats",e);let r={};const t=e.result.columnHeaders,s=e.result.rows[0];for(let e=0;e<s.length;e++)r[t[e].name]=s[e];return r.netSubscribersGained=r.subscribersGained-r.subscribersLost,delete r.subscribersGained,delete r.subscribersLost,r}).catch(e=>{const r="Error getting Real Time Stats: ";throw console.error(r,e),recordError(e,r),e})}function requestRealTimeStatsCumulative(){return requestRealTimeStats(joinDate,getDateFromDaysAgo(4))}function requestRealTimeStatsMonth(){return requestRealTimeStats(getDateFromDaysAgo(34),getDateFromDaysAgo(4))}function requestRealTimeStatsToday(){const e=getDateFromDaysAgo(3);return requestRealTimeStats(e,e)}function realTimeStatsCalls(){let e=[];return e.push(requestRealTimeStatsToday()),e.push(requestRealTimeStatsMonth()),e.push(requestRealTimeStatsCumulative()),Promise.all(e).then(e=>{const r={today:e[0],month:e[1],cumulative:e[2]};return lsSet("realTimeStats",r),displayRealTimeStats(r),saveRealTimeStatsToSheets(r)}).then(e=>"Real Time Stats Completed").catch(e=>{const r="Error occurred in Real Time Stats Calls: ";console.error(r,e),recordError(e,r)})}function getTopTenVideosByMonthSince(e){e=e||new Date("2010-07-1");let r=[],t=void 0;const s=new Date;for(;s-e>0;){const s=getYouTubeDateFormat(e),o=getYouTubeDateFormat(new Date(e.getFullYear(),e.getMonth()+1,0)),a=s.substr(0,7);null==t&&(t=a),r.push(requestMostWatchedVideos(s,o,20,a)),e=new Date(e.getFullYear(),e.getMonth()+1,1)}return Promise.all(r).then(e=>{const r=[].concat.apply([],e),s={values:r},o=3+monthDiff(new Date(2010,6),new Date(t)),a="Top Ten Videos!A"+o;return updateSheetData("Stats",a,s)}).catch(e=>{const r="Error occurred getting Top Ten Videos By Month: ";console.error(r,e),recordError(e,r)})}function requestVideoBasicStats(e,r,t,s,o){const a="video=="+t,n={dimensions:"video",endDate:r,filters:a,ids:"channel==UCR5c2ZGLZY2FFbxZuSxzzJg",metrics:"views,comments,likes,dislikes,estimatedMinutesWatched,averageViewDuration,subscribersGained,subscribersLost",startDate:e};return gapi.client.youtubeAnalytics.reports.query(n).then(e=>{console.log("Top Video Basic Stats",e);const r=displayVideoBasicStats(e,s,o);saveTopVideoStatsToSheets(r);return"Displayed Top Video Basic Stats"}).catch(e=>{const r=`Error getting basic stats for video: ${t} - `;throw console.error(r,e),recordError(e,r),new Error("Error in requestVideoBasicStats")})}function requestVideoSearchTerms(e,r,t,s){const o="video=="+t+";insightTrafficSourceType==YT_SEARCH",a={dimensions:"insightTrafficSourceDetail",endDate:r,filters:o,ids:"channel==UCR5c2ZGLZY2FFbxZuSxzzJg",maxResults:10,metrics:"views",sort:"-views",startDate:e};return gapi.client.youtubeAnalytics.reports.query(a).then(e=>(console.log("Top Video Search Terms",e),displayVideoSearchTerms(e,s),Promise.resolve(`Displayed Search Terms: ${t}`))).catch(e=>{const r=`Error getting search terms for video: ${t} - `;console.error(r,e),recordError(e,r);const o=getDashboardGraphIds(s),a=o.searchTerms;throw displayGraphError(a),new Error("Error in requestVideoSearchTerms")})}function topVideoCalls(e,r,t,s){let o=[];const a=displayTopVideoTitles(s);o.push(requestVideoBasicStats(e,r,t,s,a));for(const t in s)if(s.hasOwnProperty(t)){const a=s[t];o.push(requestVideoSearchTerms(e,r,t,a)),o.push(requestVideoDailyViews(getDateFromDaysAgo(32),r,t,a))}return Promise.all(o).then(e=>(console.log("Top Video Calls Result",e),Promise.resolve("Top Video Calls completed"))).catch(e=>{const r=`Error making Top Video Calls for video: ${t} - `;console.error(r,e),recordError(e,r)})}function getCardPerformanceByMonthSince(e){e=e||new Date("2017-10-1");let r=[],t=void 0;const s=new Date;for(;s-e>0;){const s=getYouTubeDateFormat(e),o=getYouTubeDateFormat(new Date(e.getFullYear(),e.getMonth()+1,0)),a=s.substr(0,7);null==t&&(t=a),r.push(requestCardPerformance(s,o,a)),e=new Date(e.getFullYear(),e.getMonth()+1,1)}return Promise.all(r).then(e=>{const r=[].concat.apply([],e),s={values:r},o=3+monthDiff(new Date(2017,9),new Date(t)),a="Card Performance!A"+o;return updateSheetData("Stats",a,s)}).catch(e=>{const r="Error occurred getting Card Performance By Month: ";console.error(r,e),recordError(e,r)})}function getCardPerformanceForCurrMonth(){const[e,r,t]=getCurrMonth(),s=requestCardPerformance(e,r,t);return s.then(e=>{const r={values:[e]},s=3+monthDiff(new Date(2017,9),new Date(t)),o="Card Performance!A"+s;return updateSheetData("Stats",o,r)})}function requestCardPerformance(e,r,t){const s={endDate:r,ids:"channel==UCR5c2ZGLZY2FFbxZuSxzzJg",metrics:"cardImpressions,cardClickRate,cardTeaserImpressions,cardTeaserClickRate",startDate:e};return gapi.client.youtubeAnalytics.reports.query(s).then(e=>{console.log(`Card Performance for month: ${t}`,e);let r=[t,0,0,0,0];try{const s=e.result.rows[0],o=parseInt(s[0]),a=parseFloat(s[1]).toFixed(4),n=parseInt(s[2]),i=parseFloat(s[3]).toFixed(4);r[1]=o,r[2]=a,r[3]=n,r[4]=i}catch(e){const r=`No card data exists for month: "${t}" - `;console.log(r),recordError(e,r)}return r}).catch(e=>{const r=`Error getting card performance for month: ${t} - `;console.error(r,e),recordError(e,r)})}