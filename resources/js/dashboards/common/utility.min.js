function createGraph(e,t,n,a,o,s,i,r){try{Plotly.newPlot(e,t,n,a),null!=i&&1!=i||recordGraphData(e,t,n,a,o,s,r),recordGraphSize(e,o,s,r)}catch(e){throw e}}function recordGraphData(e,t,n,a,o,s,i){let r=document.querySelectorAll(".graph-container").length,l=lsGet("graphData");l&&(i||(i="None"),l[e]={data:t,layout:n,config:a,graphHeight:o,graphWidth:s,automargin:i},Object.keys(l).length==r?(lsSet("graphData",l),gapi.auth2.getAuthInstance().isSignedIn.get()&&saveGraphDataToSheets()):lsSet("graphData",l))}function recordGraphSize(e,t,n,a){lsGet("graphSizes")||lsGet("graphSizes",{});let o=lsGet("graphSizes");o[e]={height:t,width:n},a&&(o[e].automargin=a),lsSet("graphSizes",o)}function resetGraphData(){lsSet("graphData",{}),lsSet("graphSizes",{})}function resizeGraphs(){const e=lsGet("graphSizes"),t=document.documentElement.clientHeight,n=document.documentElement.clientWidth;for(const a in e)if(e.hasOwnProperty(a)){const o=e[a],s=o.height*t,i=o.width*n,r={height:s,width:i};Plotly.relayout(a,r)}}function displayGraphError(e,t){t&&recordError(t,`Unable to display graph "${e}" - `);let n='\n    <div class="h-100 w-100 position-relative">\n      <div class="alert alert-danger graph-error h3" role="alert">\n        <i class="fas fa-exclamation-triangle"></i>\n        Error loading graph\n      </div>\n    </div>\n  ';const a=document.getElementById(e);a.innerHTML=n}function fixGraphMargins(){let e=lsGet("graphSizes");for(var t in e){let n=e[t].automargin;n&&Plotly.relayout(t,n)}}function calcVideographerStats(){const e=lsGet("allVideoStats"),t=lsGet("statsByVideoId");let n={};for(let a=0;a<e.length;a++){const o=e[a],s=o.videoId,i=t[s].createdBy,r=t[s].organic;n[i]||(n[i]={all:{totalComments:0,totalDislikes:0,totalDuration:0,totalLikeRatio:0,totalLikes:0,totalSubsGained:0,totalViews:0,videos:[]},organic:{totalComments:0,totalDislikes:0,totalDuration:0,totalLikeRatio:0,totalLikes:0,totalSubsGained:0,totalViews:0,videos:[]},notOrganic:{totalComments:0,totalDislikes:0,totalDuration:0,totalLikeRatio:0,totalLikes:0,totalSubsGained:0,totalViews:0,videos:[]}});let l=[n[i].all];r?l.push(n[i].organic):l.push(n[i].notOrganic);const u=o.comments,c=o.dislikes,d=o.duration,g=o.likes/(o.likes+o.dislikes),p=o.likes,h=o.subscribersGained,m=o.views;l.forEach(e=>{e.totalComments+=u,e.totalDislikes+=c,e.totalDuration+=d,isNaN(g)||(e.totalLikeRatio+=g),e.totalLikes+=p,e.totalSubsGained+=h,e.totalViews+=m,e.videos.push(s)})}for(const e in n)if(n.hasOwnProperty(e)){const t=n[e];for(const e in t)if(t.hasOwnProperty(e)){const n=t[e];let a=n.videos.length;n.numVideos=a,0==a&&(a=1),n.avgComments=n.totalComments/a,n.avgDislikes=n.totalDislikes/a,n.avgDuration=n.totalDuration/a,n.avgLikeRatio=n.totalLikeRatio/a,n.avgLikes=n.totalLikes/a,n.avgSubsGained=n.totalSubsGained/a,n.avgViews=n.totalViews/a;let o=n.avgLikes/(n.avgLikes+n.avgDislikes);isNaN(o)&&(o=void 0),n.cumLikeRatio=o}}return n=calcVideographerVideosByMonth(n),lsSet("videographers",n),n}function updateTheme(e){try{if(gapi.auth2.getAuthInstance().isSignedIn.get()){var t=document.getElementsByClassName("carousel-item")[e],n=document.getElementsByTagName("body")[0];"dark"==t.getAttribute("theme")?(n.className="dark","platform"==t.id&&document.getElementsByClassName("demographics-table")[0].classList.add("table-dark")):n.className=""}}catch(e){console.error(e),recordError(e)}}function getDashboardGraphIds(e){if("categoryGraphs"==e)return currentSettings.categoryGraphs;if("videographerGraphs"==e)return currentSettings.videographerGraphs;if("contestGraphs"==e)return currentSettings.contestGraphs;if("contest-video-"==e.substr(0,14)){let t=/[^-]*$/.exec(e)[0],n=currentSettings.contestGraphs,a={};for(const e in n)if(n.hasOwnProperty(e)){const o=n[e];a[e]=o.replace("#",t)}return a}if("top-video-"==e.substr(0,10)){let t=/[^-]*$/.exec(e)[0],n=currentSettings.topVideoGraphs,a={};for(const e in n)if(n.hasOwnProperty(e)){const o=n[e];a[e]=o.replace("#",t)}return a}const t=currentSettings.dashboards;let n=0;for(;n<t.length;){const a=t[n];if(a.name==e)return a.graphIds;n++}return null}function carouselNext(){$(".carousel-container.active > .carousel").carousel("next")}function carouselPrev(){$(".carousel-container.active > .carousel").carousel("prev")}function pauseDashboard(){let e=document.getElementById("pause-text"),t=document.getElementById("play-text");$(".dashboard-carousel").carousel("pause"),e.style.display="initial",t.style.display="none",isPaused=!0}function playDashboard(){let e=document.getElementById("pause-text"),t=document.getElementById("play-text");$(".dashboard-carousel").carousel("cycle"),e.style.display="none",t.style.display="initial",setTimeout(function(){0!=t.offsetHeight&&$("#play-text").fadeOut()},2e3),isPaused=!1}function toggleDashboardPause(){isPaused?playDashboard():pauseDashboard()}function temporarilyToggleDashboardPause(e){e?$(".dashboard-carousel").carousel("pause"):isPaused||$(".dashboard-carousel").carousel("cycle")}function goToCarouselItem(e){$(".carousel-container.active > .carousel").carousel(e)}function hideMenu(){document.body.removeAttribute("menu"),isMenuOpen=!1}function showMenu(){document.body.setAttribute("menu","open"),isMenuOpen=!0}function toggleMenuVisibility(){isMenuOpen?hideMenu():showMenu()}function nextMenuItem(){switchMenuItem(1)}function prevMenuItem(){switchMenuItem(-1)}function switchMenuItem(e){let t=document.getElementById("menu-group"),n=t.children.length,a=document.activeElement,o=parseInt(a.getAttribute("menu-index"));isNaN(o)&&(o=e>0?-1:0);let s=o+e,i=(s%n+n)%n,r=document.querySelector(`.menu-item[menu-index='${i}']`);r.focus()}function selectMenuItem(e){const t=document.querySelector(`.menu-item.item-${e}`);t&&t.focus()}function addDotsToLoadingText(){const e=document.getElementById("loading-text");e.innerHTML.endsWith("...")||(e.innerHTML+="...")}function hideLoadingText(){const e=document.getElementById("loading-text");e.style.display="none"}function showLoadingText(){const e=document.getElementById("loading-text");e.style.display="initial"}function hideUpdatingText(){const e=document.getElementById("updating-text");e.style.display="none"}function showUpdatingText(){const e=document.getElementById("updating-text");e.style.display="initial"}function setLoadingStatus(e){isLoading=e,temporarilyToggleDashboardPause()}function setUpdatingStatus(e){isUpdating=e,temporarilyToggleDashboardPause()}function getCurrentSettings(){lsGet("settings")||lsSet("settings",defaultSettings),window.currentSettings=lsGet("settings");const e=currentSettings.version,t=defaultSettings.version;(null==e||t>e)&&(lsSet("settings",defaultSettings),window.currentSettings=defaultSettings),window.cycleSpeed=1e3*currentSettings.cycleSpeed}function createEventListeners(){document.addEventListener("keyup",function(e){"M"==e.key.toUpperCase()&&gapi.auth2.getAuthInstance().isSignedIn.get()&&toggleMenuVisibility(),isMenuOpen?isNaN(e.key)||32==e.which?"ArrowDown"==e.key?nextMenuItem():"ArrowUp"==e.key&&prevMenuItem():selectMenuItem(e.key):"ArrowLeft"==e.key?carouselPrev():"ArrowRight"==e.key?carouselNext():32==e.which?toggleDashboardPause():"F2"==e.key?signIn():"A"==e.key.toUpperCase()?goToCarouselItem(9):"B"==e.key.toUpperCase()?goToCarouselItem(10):"C"==e.key.toUpperCase()?goToCarouselItem(11):"D"==e.key.toUpperCase()?goToCarouselItem(12):"E"==e.key.toUpperCase()?goToCarouselItem(13):"F"==e.key.toUpperCase()?goToCarouselItem(14):isNaN(e.key)||32==e.which?"U"==e.key.toUpperCase()&&e.altKey&&gapi.auth2.getAuthInstance().isSignedIn.get()?updateDashboards():"L"==e.key.toUpperCase()&&e.altKey&&loadDashboards():e.ctrlKey||e.altKey?goToCarouselItem(parseInt(e.key)+9):goToCarouselItem(parseInt(e.key)-1)}),$(".carousel").on("slide.bs.carousel",function(e){let t=e.target.getAttribute("name"),n=t+"-indicator-",a=document.getElementById(n+e.from),o=document.getElementById(n+e.to);a.classList.remove("active"),o.classList.add("active")}),$(".menu-item").on("mousemove",function(){document.activeElement.blur()}),window.addEventListener("resize",function(){retry(resizeGraphs,5,5e3)},!0)}getCurrentSettings(),initializeCarousels(),createEventListeners();let isLoading=!1,isMenuOpen=!1,isPaused=!1,isUpdating=!1;