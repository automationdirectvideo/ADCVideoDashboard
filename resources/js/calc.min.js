function updateDashboards(){if(!isLoading&&!isUpdating){isUpdating=!0,showUpdatingText();const e=new Date;let t=[];if(0==e.getMonth()&&e.getDate()>=10&&e.getDate<=20){const a=e.getFullYear()-1;t.push(getYearlyCategoryViews(a))}return t.push(getCardPerformanceForCurrMonth()),t.push(realTimeStatsCalls()),t.push(updateVideoAndCategoryStats()),Promise.all(t).then(e=>(console.log("Update Dashboards Complete",e),recordUpdate("Dashboards Updated"),hideUpdatingText(),isUpdating=!1,loadDashboards())).catch(e=>{recordUpdate("Update Failed");const t="Error occurred updating dashboards: ";console.error(t,e),recordError(e,t)}).finally(e=>{hideUpdatingText(),isUpdating=!1})}}function updateVideoAndCategoryStats(){const e=getCategoryList(),t=getVideoList();return Promise.all([e,t]).then(e=>{e[0],e[1][0];const t=e[1][1];return getAllVideoStats(t)}).then(e=>getTopTenVideosForCurrMonth())}function getCategoryList(){return requestSpreadsheetData("Input Data","Category List").then(e=>{let t={};const a=getColumnHeaders(e);for(let r=1;r<e.length;r++){const o=e[r];let s=o[a["Category ID"]];const n=o[a["L1 Category"]],i=o[a["L2 Category"]],l=o[a["L3 Category"]];let d="";const c=o[a["Short Name"]];let h=!1;const u=!0;if(/\d/.test(s)){const e=s.match(/[A-Z]+/)[0];if(t[e].leaf=!1,d=t[e].name+"->"+i,""!=s.replace(/[A-Z]+[0-9]+/,"")){const e=s.match(/[A-Z]+[0-9]+/)[0];t[e].leaf=!1,d=t[e].name+"->"+l}}else h=!0,d=n;t[s]={shortName:c,name:d,root:h,leaf:u,views:0,likes:0,duration:0,videos:[],strength:0}}return lsSet("categoryTotals",t),t})}function getVideoList(){return requestSpreadsheetData("Input Data","Video List").then(e=>{let t={},a=[],r={};const o=e[0];for(let e=0;e<o.length;e++)r[o[e]]=e;for(let o=1;o<e.length;o++){const s=e[o],n="TRUE"===s[r.Organic];if(n){const e=s[r["Video ID"]],o=s[r.Title],n=s[r["Publish Date"]],i=s[r.Duration];let l=s[r.Categories];const d=s[r["Created By"]],c=s[r.Privacy].toLowerCase();l=l.replace(/\s/g,"");const h=l.split(",");let u=[];for(let e=0;e<h.length;e++){let t=h[e];if(-1==u.indexOf(t)&&u.push(t),/\d/.test(t)){const e=t.match(/[A-Z]+/)[0];if(-1==u.indexOf(e)&&u.push(e),""!=t.replace(/[A-Z]+[0-9]+/,"")){const e=t.match(/[A-Z]+[0-9]+/)[0];-1==u.indexOf(e)&&u.push(e)}}}t[e]={categories:u,title:o,publishDate:n,duration:i,createdBy:d,privacy:c},a.push(e)}}return lsSet("statsByVideoId",t),lsSet("uploads",a),[t,a]})}function getCategoryStats(){return requestSpreadsheetData("Stats","Category Stats").then(e=>{const t=getColumnHeaders(e);let a=[];for(let r=1;r<e.length;r++){const o=e[r],s=o[t["Category ID"]],n=o[t.Name],i=o[t["Short Name"]],l=parseInt(o[t.Views]),d=parseInt(o[t.Likes]),c=parseInt(o[t["Duration (sec)"]]),h=parseFloat(o[t["Average Video Views"]]),u=parseFloat(o[t["Average Video Likes"]]),p=parseFloat(o[t["Average Video Duration"]]),g=parseFloat(o[t.Strength]),m=o[t.Videos],y=m.split(","),f="TRUE"===o[t.Root],v="TRUE"===o[t.Leaf];a.push({categoryId:s,name:n,shortName:i,views:l,likes:d,duration:c,avgViews:h,avgLikes:u,avgDuration:p,avgStrength:g,videos:y,root:f,leaf:v})}return lsSet("categoryStats",a),a})}function getVideoStats(){return requestSpreadsheetData("Stats","Video Stats").then(e=>{const t=getColumnHeaders(e);let a=[],r=[],o={};for(let s=1;s<e.length;s++){const n=e[s],i=n[t["Video ID"]],l=n[t.Title],d=parseInt(n[t.Views]),c=parseInt(n[t.Likes]),h=parseInt(n[t.Dislikes]),u=parseInt(n[t["Duration (sec)"]]),p=parseInt(n[t.Comments]),g=n[t["YouTube Publish Date"]].substr(0,10),m=n[t.Categories].replace(/\s/g,""),y=n[t["Created By"]],f=parseFloat(n[t.Strength]),v=parseInt(n[t["Average View Duration"]]),S=parseFloat(n[t["Average View Percentage"]]),b=parseFloat(n[t["Average Views Per Day"]]),D=parseInt(n[t["Days Since Published"]]),V=parseInt(n[t["Subscribers Gained"]]),w=parseFloat(n[t["Likes Per View"]]),C=parseFloat(n[t["Dislikes Per View"]]),P={videoId:i,views:d,likes:c,dislikes:h,comments:p,duration:u,strength:f,avgViewDuration:v,avgViewPercentage:S,avgViewsPerDay:b,daysSincePublished:D,subscribersGained:V,likesPerView:w,dislikesPerView:C};r.push(P),o[i]||(o[i]={}),o[i].title=l,o[i].publishDate=g,o[i].duration=u,o[i].categories=m,o[i].createdBy=y,a.push(i)}lsSet("allVideoStats",r),lsSet("statsByVideoId",o),lsSet("uploads",a)})}function getBasicDashboardStats(){let e=[];return e.push(getCategoryStats()),e.push(getVideoStats()),e.push(getVideoStrengthWeights()),e.push(realTimeStatsCalls()),Promise.all(e)}function getVideoStrengthWeights(){return requestSpreadsheetData("Input Data","Video Strength Calculation").then(e=>{let t={},a=getColumnHeaders(e);for(let r=1;r<e.length;r++){const o=e[r];let s=o[a["Short Name"]],n=parseFloat(o[a.Weight]);t[s]=n}return lsSet("weights",t),Promise.resolve(t)})}function loadPlatformDashboard(){const e=joinDate,t=getTodaysDate();let a=[];return a.push(requestChannelSearchTerms(e,t)),a.push(requestViewsByDeviceType(e,t)),a.push(requestViewsByTrafficSource(e,t)),a.push(requestViewsByState(e,t)),a.push(requestChannelDemographics(e,t)),a.push(requestWatchTimeBySubscribedStatus(e,t)),Promise.all(a).then(e=>(console.log("Platform Dashboard Calls Status:",e),"Displayed Platform Dashboard")).catch(e=>{const t="Error loading the Platform Dashboard: ";console.error(t,e),recordError(e,t)})}function loadChannelDemographics(){return requestSpreadsheetData("Stats","Channel Demographics").then(e=>{const t=JSON.parse(e[0][0]),a={result:{rows:t}};return displayChannelDemographics(a)})}function loadTopTenDashboard(){return requestSpreadsheetData("Stats","Top Ten Videos").then(e=>{const t=lsGet("statsByVideoId");let a="";for(let r=1;r<e.length;r++)for(let o=0;o<11;o++){const s=e[r];if(0==o)a+=`<div class="column-title"><h4>${s[o]}</h4></div>`;else{const n=s[o],i=numberWithCommas(parseInt(s[o+10])),l=numberWithCommas(parseInt(s[o+20]));let d="YouTube Video ID: "+n;if(t&&t[n]&&(d=t[n].title),d+=` | ${i} views & ${l} minutes watched`,a+=`\n              <div class="top-ten-thumbnail-holder column-thumbnail">\n                <a href="https://youtu.be/${n}" target="_blank"\n                    alt="${d}">\n                  <img class="top-ten-thumbnail"\n                      src="https://i.ytimg.com/vi/${n}/mqdefault.jpg" \n                      alt="thumbnail" title="${d}">`,1!=r){const t=o,s=e[r-1],i=s.indexOf(n);if(-1==i)a+='\n                  <span class="oi oi-arrow-thick-top arrow-green"></span>\n                  <span class="arrow-text-black">+</span>\n                ';else if(i!=t){const e=i-t;e<0?a+=`\n                    <span class="oi oi-arrow-thick-bottom arrow-red"></span>\n                    <span class="arrow-text-white">${Math.abs(e)}</span>\n                  `:e>0&&(a+=`\n                    <span class="oi oi-arrow-thick-top arrow-green"></span>\n                    <span class="arrow-text-black">${e}</span>\n                  `)}}a+="</a></div>"}}let r=document.getElementById("top-ten-thumbnail-container");r.innerHTML=a;let o=document.getElementById("top-ten-thumbnail-wrapper");return o.scrollLeft=o.scrollWidth,Promise.resolve("Displayed Top Ten Videos Dashboard")})}function loadUserFeedbackDashboard(){return requestSpreadsheetData("Input Data","User Feedback List").then(e=>{const t=lsGet("statsByVideoId");let a="";for(let r=1;r<e.length;r++){const o=e[r][0],s=e[r][1];let n="YouTube Video ID: "+o;t&&t[o]&&(n=t[o].title);const i=`\n          <div class="col-4">\n            <a href="https://youtu.be/${o}" target="_blank"\n                alt="${n}">\n              <img class="feedback-thumbnail" onload="thumbnailCheck($(this), true)"\n                  src="https://i.ytimg.com/vi/${o}/maxresdefault.jpg"\n                  alt="thumbnail" title="${n}">\n            </a>\n          </div>`,l=`\n          <div class="col-8">\n            <h1 class="feedback-text">"${s}"</h1>\n          </div>\n        `,d='<div class="col-12"><hr></div>';a+=r%2==0?l+i:i+l,r!=e.length-1&&(a+=d)}let r=document.getElementById("feedback-container");if(r.innerHTML=a,!autoScrollDivs.includes("feedback-wrapper")){const e=lsGet("settings");let t=-1,a=0;for(;-1==t&&a<=e.dashboards.length;){const r=e.dashboards[a];"top-ten"==r.name&&(t=r.scrollSpeed),a++}t=t<=0?0:Math.ceil(1e3/t),new AutoDivScroll("feedback-wrapper",t,1,1),autoScrollDivs.push("feedback-wrapper")}return Promise.resolve("Displayed User Feedback Dashboard")})}function loadCardPerformanceDashboard(){return requestSpreadsheetData("Stats","Card Performance").then(e=>{e.shift();let t=[],a=[],r=[],o=[],s=[],n=e.length;const i=e[e.length-1];0==i[1]&&0==i[3]&&n--;for(let i=0;i<n;i++)t.push(e[i][0]),a.push(e[i][1]),r.push(100*e[i][2]),o.push(e[i][3]),s.push(100*e[i][4]);const l={x:t,y:a,type:"bar",hovertemplate:"%{y} Impressions<extra></extra>",name:"Card Impressions"},d={x:t,y:r,type:"scatter",hovertemplate:"%{y} Click Rate<extra></extra>",line:{width:4},name:"Card Click Rate",yaxis:"y2"},c={x:t,y:o,type:"bar",hovertemplate:"%{y:,g} Teaser Impressions<extra></extra>",name:"Card Teaser Impressions"},h={x:t,y:s,type:"scatter",hovertemplate:"%{y} Teaser Click Rate<extra></extra>",line:{width:4},name:"Card Teaser Click Rate",yaxis:"y2"},u=[l,d],p=[c,h],g=.4159,m=.9192,y=.9528,f=g*document.documentElement.clientHeight,v=m*document.documentElement.clientWidth,S=y*document.documentElement.clientWidth,b=Math.floor(.017*document.documentElement.clientHeight),D=Math.floor(.0094*document.documentElement.clientWidth),V=Math.floor(.013*document.documentElement.clientWidth),w=Math.floor(.0156*document.documentElement.clientWidth),C=Math.floor(.03*document.documentElement.clientWidth),P=Math.floor(.0104*document.documentElement.clientWidth),k={height:f,width:v,legend:{bgcolor:"#eeeeee",font:{size:b},x:1.1,y:.5},margin:{b:P,t:C},title:{font:{size:w},text:"Card Performance"},xaxis:{automargin:!0,fixedrange:!0,hoverformat:"%b %Y",tickformat:"%b<br>%Y",tickfont:{size:D},title:{font:{size:V},text:"Month"}},yaxis:{automargin:!0,fixedrange:!0,tickfont:{size:D},title:{font:{size:V},text:"Card Impressions"}},yaxis2:{automargin:!0,fixedrange:!0,showgrid:!1,tickfont:{size:D},title:{font:{size:V},text:"Card Click Rate"},overlaying:"y",side:"right",ticksuffix:"%",zeroline:!1}},I={scrollZoom:!1,displayModeBar:!1};let T=JSON.parse(JSON.stringify(k));T.title.text="Card Teaser Performance",T.yaxis.title.text="Card Teaser Impressions",T.width=S;const x="card-teaser-performance-graph",B="card-performance-graph";let E=0;try{Plotly.newPlot(x,p,T,I),recordGraphData(x,p,T,I,g,m),recordGraphSize(x,g,y)}catch(e){E++,displayGraphError(x,e)}try{Plotly.newPlot(B,u,k,I),recordGraphData(B,u,k,I,g,m),recordGraphSize(B,g,m)}catch(e){E++,displayGraphError(B,e)}return E>0?Promise.resolve("Error Displaying Card Performance Dashboard"):Promise.resolve("Displayed Card Performance Dashboard")})}function loadRealTimeStatsDashboard(){const e=gapi.auth2.getAuthInstance().isSignedIn.get();if(!e)return requestSpreadsheetData("Stats","Real Time Stats").then(e=>{let t={};const a=getColumnHeaders(e);for(let r=1;r<e.length;r++){const o=e[r],s=o[a["Time Range"]],n=o[a.Views],i=o[a["Estimated Minutes Watched"]],l=o[a["Average View Duration"]],d=o[a["Subscribers Gained"]];t[s]={views:parseInt(n),estimatedMinutesWatched:parseInt(i),averageViewDuration:parseInt(l),netSubscribersGained:parseInt(d)}}return lsSet("realTimeStats",t),displayRealTimeStats(t)});try{return displayRealTimeStats()}catch(e){return recordError(e),realTimeStatsCalls()}}function loadGraphsFromSheets(){return requestSpreadsheetData("Stats","Graph Data").then(e=>{let t=0;const a=getColumnHeaders(e);for(let r=1;r<e.length;r++){const o=e[r],s=o[a["Graph ID"]],n=JSON.parse(o[a.Data]),i=JSON.parse(o[a.Layout]),l=JSON.parse(o[a.Config]),d=parseFloat(o[a["Graph Height"]]),c=parseFloat(o[a["Graph Width"]]),h=JSON.parse(o[a.Automargin]);try{Plotly.newPlot(s,n,i,l),"None"!=h?recordGraphSize(s,d,c,h):recordGraphSize(s,d,c)}catch(e){console.error(e),recordError(e),displayGraphError(s),t++}}return Promise.resolve("Displayed Graphs From Sheets with "+t+" errors")})}function loadTopVideoStats(){return requestSpreadsheetData("Stats","Top Video Stats").then(e=>{const t=getColumnHeaders(e);let a={},r=[];for(let o=1;o<e.length;o++){const s=e[o],n=s[t["Video ID"]],i=s[t["Dashboard ID"]],l=s[t.Title],d=s[t.Duration],c=s[t["Publish Date"]],h=s[t.Thumbnail],u=s[t.Views],p=s[t["Subscribers Gained"]],g=s[t["Average View Duration"]],m=s[t["Estimated Minutes Watched"]],y=s[t.Comments],f=parseInt(s[t.Likes]),v=parseInt(s[t.Dislikes]);try{document.getElementById(i+"-title").innerHTML=l,document.getElementById(i+"-duration").innerHTML="Duration: "+secondsToDuration(d),document.getElementById(i+"-duration-seconds").innerHTML=d,document.getElementById(i+"-publish-date").innerHTML="Published: "+c,document.getElementById(i+"-thumbnail").innerHTML=h;const e=[n,u,y,f,v,m,g,p,0];r.push(e),a[n]=i}catch(e){const t=`Dashboard "${i}" does not exist - `;console.error(t,e),recordError(e,t)}}const o={result:{rows:r}};return displayVideoBasicStats(o,a),Promise.resolve("Displayed Top Video Dashboards")})}function loadCategoryCharts(){return requestSpreadsheetData("Stats","Category Views By Year").then(e=>{const t=recordYearlyCategoryViews(e);return displayCategoryViewsAreaCharts(t)})}function loadProductCategoriesDashboard(){return displayTopCategoriesGraphOne(),displayTopCategoriesGraphTwo(),displayTopCategoriesGraphThree(),Promise.resolve("Displayed Product Categories Dashboard")}function loadThumbnailDashboard(){const e=gapi.auth2.getAuthInstance().isSignedIn.get();if(e){const e=displayUploadThumbnails(),t={part:"statistics",forUsername:"automationdirect"},a=gapi.client.youtube.channels.list(t).then(e=>{const t=e.result.items[0].statistics.videoCount;document.getElementById("num-videos").innerText=t}).catch(e=>{const t="Unable to get number of channel videos: ";console.error(t,e),recordError(e,t)});return Promise.all([a,e])}return displayUploadThumbnails()}function loadTopVideoDashboards(){const e=document.getElementsByClassName("carousel-inner")[0],t=getTodaysDate();let a=[],r={};if(e.children["top-video-1"]){const e=getTopVideoByCategory("B","views")[0];null!=e&&(r[e]="top-video-1",a.push(e))}if(e.children["top-video-2"]){const e=getTopVideoByCategory("C","views")[0];null!=e&&(r[e]="top-video-2",a.push(e))}if(e.children["top-video-3"]){const e=getTopVideoByCategory("D","views")[0];null!=e&&(r[e]="top-video-3",a.push(e))}if(e.children["top-video-4"]){const e=getTopVideoByCategory("F","views")[0];null!=e&&(r[e]="top-video-4",a.push(e))}if(e.children["top-video-5"]){const e=getTopVideoByCategory("H","views")[0];null!=e&&(r[e]="top-video-5",a.push(e))}if(e.children["top-video-6"]){const e=getTopVideoByCategory("I","views")[0];null!=e&&(r[e]="top-video-6",a.push(e))}if(0==a.length)return null;const o=a.join(",");return topVideoCalls(joinDate,t,o,r)}function loadVideoStrengthDashboard(){const e=lsGet("statsByVideoId"),t=lsGet("allVideoStats");t.sort(function(e,t){return e.strength==t.strength?t.totalStrength-e.totalStrength:t.strength-e.strength});let a=20,r="",o=[];for(var s=0;s<a;s++){const n=t[s],i=n.videoId,l=Math.round(100*n.strength)/100;let d="YouTube Video ID: "+i,c=`video-strength-bars-${s+1}`;o.push({videoStats:n,graphId:c}),e&&e[i]&&(d=e[i].title),r+=`\n      <div class="col-1">\n        <h1 style="font-size:5rem;">${s+1}.</h1>\n      </div>\n      <div class="col-3">\n        <a href="https://youtu.be/${i}" target="_blank"\n            alt="${d}">\n          <img class="feedback-thumbnail" onload="thumbnailCheck($(this), true)"\n              src="https://i.ytimg.com/vi/${i}/maxresdefault.jpg"\n              alt="thumbnail" title="${d}">\n        </a>\n      </div>\n      <div class="col-4">\n        <h1 class="video-strength-title">${d}</h1>\n        <br>\n        <h2 class="video-strength-value">Strength: ${l}</h2>\n      </div>\n      <div class="col-4">\n        <div class="h-100 w-100 graph-container" id="${c}"></div>\n      </div>\n    `;const h='\n      <div class="col-12">\n        <hr style="border-top:0.25rem solid rgba(0,0,0,.3);">\n      </div>\n    ';s!=a-1&&(r+=h)}let n=document.getElementById("video-strength-container");if(n.innerHTML=r,!autoScrollDivs.includes("video-strength-wrapper")){let e=lsGet("settings"),t=-1,a=0;for(;-1==t&&a<=e.dashboards.length;){let r=e.dashboards[a];"video-strength"==r.name&&(t=r.scrollSpeed),a++}t=t<=0?0:Math.ceil(1e3/t),new AutoDivScroll("video-strength-wrapper",t,1,1),autoScrollDivs.push("video-strength-wrapper")}if(gapi.auth2.getAuthInstance().isSignedIn.get())if(void 0===t[0].z)reloadVideoStrengthDashboard();else for(let e=0;e<o.length;e++){const t=o[e];displayVideoStrengthBars(t.videoStats,t.graphId)}}function reloadVideoStrengthDashboard(){return getVideoStrengthWeights().then(e=>{try{const t=lsGet("allVideoStats");let a=calcVideoStrength(t,e);lsSet("allVideoStats",a),loadVideoStrengthDashboard()}catch(e){const t="Unable to recalculate video strengths";return console.error(t,e),recordError(e,t),t}})}function loadVideographerDashboards(){let e=calcVideographerStats();displayVideographerMonthlyVideos(e)}function average(e){const t=e.reduce((e,t)=>e+t,0),a=t/e.length;return a}function standardDeviation(e,t){const a=e.map(e=>{const a=e-t,r=a**2;return r}),r=average(a),o=Math.sqrt(r);return o}function zScore(e,t,a){let r=e-t,o=r/a;return o}function zScoreForList(e){let t=average(e),a=standardDeviation(e,t),r=e.map(e=>zScore(e,t,a));return r}function zScoreByPropertyName(e,t){let a=e.map(e=>e[t]),r=zScoreForList(a),o=r.map(e=>e>4?4:e<-4?-4:e);return o}function calcVideoStrength(e,t){let a={videoIds:e.map(e=>e.videoId),views:zScoreByPropertyName(e,"views"),avgViewsPerDay:zScoreByPropertyName(e,"avgViewsPerDay"),duration:zScoreByPropertyName(e,"duration"),comments:zScoreByPropertyName(e,"comments"),likesPerView:zScoreByPropertyName(e,"likesPerView"),dislikesPerView:zScoreByPropertyName(e,"dislikesPerView"),subscribersGained:zScoreByPropertyName(e,"subscribersGained"),avgViewDuration:zScoreByPropertyName(e,"avgViewDuration"),avgViewPercentage:zScoreByPropertyName(e,"avgViewPercentage"),daysSincePublished:zScoreByPropertyName(e,"daysSincePublished")};for(let r=0;r<a.videoIds.length;r++){a.videoIds[r];const o=a.views[r],s=a.avgViewsPerDay[r],n=a.duration[r],i=a.comments[r],l=a.likesPerView[r],d=a.dislikesPerView[r],c=a.subscribersGained[r],h=a.avgViewDuration[r],u=a.avgViewPercentage[r],p=a.daysSincePublished[r];let g=0;for(const e in t)if(t.hasOwnProperty(e)){const o=t[e];g+=o*a[e][r]}e[r].totalStrength=g,e[r].z={views:o,avgViewsPerDay:s,duration:n,comments:i,likesPerView:l,dislikesPerView:d,subscribersGained:c,avgViewDuration:h,avgViewPercentage:u,daysSincePublished:p}}e.sort(function(e,t){return e.totalStrength-t.totalStrength});let r=zScoreByPropertyName(e,"totalStrength"),o=r.length,s=Math.floor(0*o),n=Math.floor(o-1),i=r[s],l=r[n]-i;0==l&&(l=1);for(let t=0;t<e.length;t++){let a=r[t],o=(a-i)/l*100;e[t].strength=o}return e}function calcVideographerStats(){const e=lsGet("allVideoStats"),t=lsGet("statsByVideoId");let a={};for(let r=0;r<e.length;r++){const o=e[r],s=o.videoId,n=t[s].createdBy;a[n]||(a[n]={totalComments:0,totalDislikes:0,totalDuration:0,totalLikeRatio:0,totalLikes:0,totalSubsGained:0,totalViews:0,videos:[]}),a[n].totalComments+=o.comments,a[n].totalDislikes+=o.dislikes,a[n].totalDuration+=o.duration;let i=o.likes/(o.likes+o.dislikes);isNaN(i)||(a[n].totalLikeRatio+=i),a[n].totalLikes+=o.likes,a[n].totalSubsGained+=o.subscribersGained,a[n].totalViews+=o.views,a[n].videos.push(s)}for(const e in a)if(a.hasOwnProperty(e)){const t=a[e],r=t.videos.length;t.avgComments=t.totalComments/r,t.avgDislikes=t.totalDislikes/r,t.avgDuration=t.totalDuration/r,t.avgLikeRatio=t.totalLikeRatio/r,t.avgLikes=t.totalLikes/r,t.avgSubsGained=t.totalSubsGained/r,t.avgViews=t.totalViews/r;let o=t.avgLikes/(t.avgLikes+t.avgDislikes);isNaN(o)&&(o=void 0),t.cumLikeRatio=o}return a=calcVideographerVideosByMonth(a),lsSet("videographers",a),a}function calcVideographerVideosByMonth(e){const t=lsGet("statsByVideoId");for(const a in e)if(e.hasOwnProperty(a)){const r=e[a];let o={};const s=r.videos;s.forEach(e=>{const a=t[e].publishDate,r=a.substr(0,7);null==o[r]&&(o[r]=0),o[r]+=1});const n=getMonthsSince(2010,7);n.forEach(e=>{null==o[e]&&(o[e]=0)}),e[a].monthlyVideos=o}return e}function displayVideographerMonthlyVideos(e){e=e||lsGet("videographers");let t=[];const a=["Shane C","Rick F","Tim W"];a.forEach(a=>{const r=e[a],o=r.monthlyVideos;let s=[];for(const e in o)if(o.hasOwnProperty(e)){const t=o[e];s.push({month:e,numVideos:t})}s.sort(function(e,t){return e.month>t.month?1:e.month==t.month?0:-1});let n=[],i=[],l=[];s.forEach(e=>{n.push(e.month),i.push(e.numVideos),1==e.numVideos?l.push("1 video"):l.push(`${e.numVideos} videos`)});let d={x:n,y:i,name:a,customdata:l,stackgroup:"one",groupnorm:"percent",hovertemplate:"%{y:.0f}% of total videos<br>%{customdata}<extra>"+a+"</extra>"};t.push(d)});const r=.8583,o=.9528,s=r*document.documentElement.clientHeight,n=o*document.documentElement.clientWidth,i=Math.floor(.0208*document.documentElement.clientWidth),l=Math.floor(.01*document.documentElement.clientWidth),d=Math.floor(.0156*document.documentElement.clientWidth),c=Math.floor(.0104*document.documentElement.clientWidth),h=Math.floor(.03*document.documentElement.clientWidth),u=Math.floor(.0104*document.documentElement.clientWidth),p={height:s,width:n,hoverlabel:{font:{size:c},namelength:-1},legend:{bgcolor:"#eeeeee",font:{size:l},y:.5},margin:{b:u,t:h},paper_bgcolor:"rgba(0,0,0,0)",plot_bgcolor:"rgba(0,0,0,0)",title:{font:{size:i},text:"Monthly Videos By Videographer"},xaxis:{automargin:!0,fixedrange:!0,tickfont:{size:c},title:{font:{size:d},text:"Month"}},yaxis:{automargin:!0,fixedrange:!0,tickfont:{size:c},ticksuffix:"%",title:{font:{size:d},text:"Percentage of Videos Created"}}},g={scrollZoom:!1,displayModeBar:!1},m="videographer-monthly-videos-chart";try{Plotly.newPlot(m,t,p,g),recordGraphData(m,t,p,g,r,o),recordGraphSize(m,r,o)}catch(e){displayGraphError(m,e)}}