function loadSignedIn(){addDotsToLoadingText();const t=document.getElementById("home-button"),e=document.getElementById("control-panel-button");t.style.display="inline",e.style.display="inline",initializeUpdater(),loadDashboards(),updateTheme(0)}function loadSignedOut(){createSignInModal("dashboards");const t=document.getElementById("authorize-button");t.onclick=handleAuthClick,$("#signinModal").modal({backdrop:"static",keyboard:!1})}function loadDashboards(){if(!isLoading&&!isUpdating){setLoadingStatus(!0);const t=gapi.auth2.getAuthInstance().isSignedIn.get();if(showLoadingText(),resetGraphData(),t){let t=lsGet("categoryStats");t?loadDashboardsSignedIn():getBasicDashboardStats().then(t=>{loadDashboardsSignedIn()})}else loadDashboardsSignedOut()}}function loadDashboardsSignedIn(){return console.log("Starting Load Dashboards Requests"),loadContestDashboards().then(t=>{console.log("Load Dashboards Complete",t),setLoadingStatus(!1),hideLoadingText()}).catch(t=>{const e="Error occurred loading dashboards: ";console.error(e,t),recordError(t,e),setLoadingStatus(!1),hideLoadingText()})}function initializeUpdater(){let t=new Date;t.setHours(0,0,0,0);const e=gapi.auth2.getAuthInstance().isSignedIn.get();var o=window.setInterval(()=>{const o=new Date;let a=Math.floor((o-t)/1e3);e&&(3600==a?recordUpdate("Reload Dashboards").then(t=>{window.location.reload()}):a%900==0&&loadDashboards())},1e3);return o}function initializeCarousels(){const t=document.getElementById("contest-carousel");t.setAttribute("data-interval",cycleSpeed),t.setAttribute("data-pause","false")}function updateDashboards(){if(!isLoading&&!isUpdating)return setUpdatingStatus(!0),showUpdatingText(),updateVideoAndCategoryStats().then(t=>(console.log("Update Dashboards Complete",t),recordUpdate("Dashboards Updated"),hideUpdatingText(),setUpdatingStatus(!1),loadDashboards())).catch(t=>{recordUpdate("Update Failed");const e="Error occurred updating dashboards: ";console.error(e,t),recordError(t,e)}).finally(t=>{hideUpdatingText(),setUpdatingStatus(!1)})}function getContestVideos(){return requestSpreadsheetData("Input Data","Contest Videos").then(t=>{let e={},o=getColumnHeaders(t);for(let a=1;a<t.length;a++){const n=t[a],s=n[o["Video ID"]],d=n[o["Example Comment"]],r=n[o["Contest End Date"]],i=n[o["Short Video Title"]],c=n[o["Contest Start Date"]];e[s]={exampleComment:d,endDate:r,shortTitle:i,startDate:c}}return Promise.resolve(e)})}function loadContestDashboards(){return getContestVideos().then(t=>{createContestVideoDashboards(Object.keys(t).length);try{displayContestComparisonGraph(t)}catch(t){const e=getDashboardGraphIds("contest-video-#").comparison;displayGraphError(e),recordError(t,"Unable to load contest comparison graph - ")}try{displayContestVideoStats(t)}catch(e){const o=getDashboardGraphIds("contest-video-#").dailyViews,a=Object.keys(t).length;for(let t=0;t<a;t++){const e=o.replace("#",t);displayGraphError(e)}recordError(e,"Unable to load contest video stats dashboards - ")}return Promise.resolve("Displayed Contest Videos")}).catch(t=>{let e=[];const o=getDashboardGraphIds("contest-video-#").comparison;e.push(o);const a=getDashboardGraphIds("contest-video-#").dailyViews;if("undefined"!=typeof cotnestVideos){const t=Object.keys(contestVideos).length;for(let o=0;o<t;o++){const t=a.replace("#",o);e.push(t)}}e.forEach(t=>{displayGraphError(t)}),recordError(t,"Unable to load contest dashboards - ")})}function createContestVideoDashboards(t){if(null!=document.getElementById("contest-video-#")){const e=document.getElementById("contest-carousel-inner"),o=document.getElementById("contest-indicator-list");let a=e.childElementCount;for(let n=0;n<t;n++){const t=`contest-video-${n}`;let s=document.getElementById("contest-video-#").cloneNode(!0),d=s.outerHTML;d=d.replace(/contest-video-#/g,t);let r=document.createElement("template");r.innerHTML=d,s=r.content.firstChild,document.createElement("div",s.outerText),s.setAttribute("theme","light");const i=document.getElementById("indicator").cloneNode(!0);i.id="contest-indicator-"+a,i.setAttribute("onclick",`goToCarouselItem(${a})`),i.setAttribute("data-target","#contest-carousel"),i.className="fas fa-gift indicator",e.appendChild(s),o.appendChild(i),a++}document.getElementById("contest-video-#").remove()}}