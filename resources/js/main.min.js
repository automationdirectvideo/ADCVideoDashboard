function loadDashboards(){if(!isLoading&&!isUpdating){setLoadingStatus(!0);const e=gapi.auth2.getAuthInstance().isSignedIn.get();if(showLoadingText(),resetGraphData(),e){let e=lsGet("categoryStats");e?loadDashboardsSignedIn():getBasicDashboardStats().then(e=>{loadDashboardsSignedIn()})}else loadDashboardsSignedOut()}}function loadDashboardsSignedIn(){const e=document.getElementsByClassName("carousel-inner")[0];let t=[];return e.children["intro-animation"]&&loadIntroAnimation(),e.children["video-strength"]&&loadVideoStrengthDashboard(),e.children["real-time-stats"]&&t.push(loadRealTimeStatsDashboard()),e.children.thumbnails&&t.push(loadThumbnailDashboard()),e.children.platform&&t.push(loadPlatformDashboard()),e.children["top-ten"]&&t.push(loadTopTenDashboard()),e.children.feedback&&t.push(loadUserFeedbackDashboard()),e.children["card-performance"]&&t.push(loadCardPerformanceDashboard()),e.children["product-categories"]&&(t.push(loadProductCategoriesDashboard()),t.push(loadCategoryCharts())),t.push(loadTopVideoDashboards()),t.push(loadVideographerDashboards()),console.log("Starting Load Dashboards Requests"),Promise.all(t).then(e=>{console.log("Load Dashboards Complete",e)}).catch(e=>{const t="Error occurred loading dashboards: ";console.error(t,e),recordError(e,t)}).finally(e=>{setLoadingStatus(!1),hideLoadingText()})}function loadDashboardsSignedOut(){const e=document.getElementsByClassName("carousel-inner")[0];let t=[];return e.children["intro-animation"]&&loadIntroAnimation(),getVideoStats().then(a=>(e.children["video-strength"]&&loadVideoStrengthDashboard(),e.children["real-time-stats"]&&t.push(loadRealTimeStatsDashboard()),e.children.thumbnails&&t.push(loadThumbnailDashboard()),e.children.platform&&t.push(loadChannelDemographics()),e.children["top-ten"]&&t.push(loadTopTenDashboard()),e.children.feedback&&t.push(loadUserFeedbackDashboard()),e.children["card-performance"]&&t.push(loadCardPerformanceDashboard()),t.push(loadGraphsFromSheets()),t.push(loadTopVideoStats()),t.push(loadVideographerDashboardsSignedOut()),console.log("Starting Load Dashboards Requests"),Promise.all(t).then(e=>{console.log("Load Dashboards Complete",e)}).catch(e=>{const t="Error occurred loading dashboards: ";console.error(t,e),recordError(e,t)}).finally(e=>{setLoadingStatus(!1),hideLoadingText()})))}function initializeUpdater(){let e=new Date;e.setHours(0,0,0,0);const t=gapi.auth2.getAuthInstance().isSignedIn.get();var a=window.setInterval(()=>{const a=new Date;let o=Math.floor((a-e)/1e3);t&&(3600==o?recordUpdate("Reload Dashboards").then(e=>{window.location.reload()}):o%3600==0?updateDashboards():o%900==0&&loadDashboards());const r=document.getElementsByClassName("carousel-inner")[0];r.children["real-time-stats"]&&updateRealTimeStats(o)},1e3);return a}function updateRealTimeStats(e){let t=lsGet("secondsPerIncrement"),a=lsGet("odometerCategories");for(var o in t)if(t.hasOwnProperty(o)&&e%t[o]==0){var r=a[o];r.forEach(e=>{var t=document.getElementById(e),a=parseInt(t.getAttribute("value"))+1;t.innerHTML=a,t.setAttribute("value",a)})}}function displayRealTimeStats(e){if(e=e||lsGet("realTimeStats"),e.cumulative&&e.month&&e.today){var t={};for(const a in e.today)e.today.hasOwnProperty(a)&&"averageViewDuration"!=a&&(t[a]=Math.round(43200/e.today[a]));lsSet("secondsPerIncrement",t);let r=new Date;r.setHours(6,0,0,0);const s=new Date,n=Math.round((s-r)/1e3);var a=document.getElementById("stat-avg-duration"),o={views:["stat-views-cumulative","stat-views-month"],estimatedMinutesWatched:["stat-minutes-cumulative","stat-minutes-month"],netSubscribersGained:["stat-subs-cumulative","stat-subs-month"],cumulative:{views:"stat-views-cumulative",estimatedMinutesWatched:"stat-minutes-cumulative",netSubscribersGained:"stat-subs-cumulative"},month:{views:"stat-views-month",estimatedMinutesWatched:"stat-minutes-month",netSubscribersGained:"stat-subs-month"}};lsSet("odometerCategories",o),["cumulative","month"].forEach(a=>{const r=o[a];for(const o in r)if(r.hasOwnProperty(o)){var s=r[o],i=document.getElementById(s),l=e[a][o];l+=Math.round(n/t[o]),i.setAttribute("value",l),i.innerHTML=l}});const i=secondsToDurationMinSec(e.cumulative.averageViewDuration);return a.innerHTML=i,a.value=e.cumulative.averageViewDuration,calcAvgVideoDuration(e.cumulative.averageViewDuration),Promise.resolve("Displayed Real Time Stats Dashboard")}}function calcAvgVideoDuration(){let e=lsGet("statsByVideoId");if(e){let t=0,a=0;for(let o in e)e.hasOwnProperty(o)&&(a+=parseInt(e[o].duration),t++);let o=a/t,r=document.getElementById("stat-avg-duration").value,s=decimalToPercent(r/o);isNaN(s)&&(s=36.1),document.getElementById("stat-avg-percentage").innerText=s+"%"}else document.getElementById("stat-avg-percentage").innerText="36.1%"}function getTopVideoByCategory(e,t,a){let o=lsGet("categoryStats"),r=lsGet("allVideoStats"),s=lsGet("statsByVideoId");r.sort(function(e,a){return parseInt(a[t])-parseInt(e[t])}),(null==a||a<=0)&&(a=1);let n=[],i=0,l=!1;for(;i<o.length&&!l;){if(o[i].categoryId==e){l=!0;let e=o[i].videos,t=0,d=0;for(;t<r.length&&d<a;){const a=r[t].videoId,o=s[a].organic;e.includes(a)&&o&&(n.push(a),d++),t++}}i++}return n}function displayCategoryViewsAreaCharts(e){let t=e.years,a=t.length,o=e.totals,r=[],s=[],n=[],i=[];for(var l in e)if(e.hasOwnProperty(l)&&"years"!=l&&"totals"!=l){let a=e[l].viewTrace,c=e[l].avgViewTrace,u=e[l].cumulativeViews,h=e[l].cumulativeAvgViewTrace,g=e[l].name,m=[];for(var d=0;d<a.length;d++){let e=(a[d]/o[d]*100).toFixed(2);m.push(e)}let p=categoryColors[g].color;null==p&&(p="#a0a0a0");let y=p+"80";r.push({x:t,y:a,stackgroup:"one",fillcolor:y,line:{color:p},hovertemplate:"%{text}% of %{x} views: <i>"+g+"</i><extra></extra>",name:g,text:m}),s.push({x:t,y:c,stackgroup:"one",fillcolor:y,line:{color:p},hovertemplate:"~%{y:,g} views per video in %{x}: <i>"+g+"</i><extra></extra>",name:g}),n.push({x:t,y:u,stackgroup:"one",fillcolor:y,line:{color:p},hovertemplate:"%{y:,g} views: <i>"+g+"</i><extra></extra>",name:g}),i.push({x:t,y:h,stackgroup:"one",fillcolor:y,line:{color:p},hovertemplate:"~%{y:,g} views per video: <i>"+g+"</i><extra></extra>",name:g})}var c=function(e,t){return parseInt(t.y[a-1])-parseInt(e.y[a-1])};r.sort(c),s.sort(c),n.sort(c),i.sort(c);var u=.8583,h=.9528,g=u*document.documentElement.clientHeight,m=h*document.documentElement.clientWidth,p=Math.floor(.017*document.documentElement.clientHeight),y=Math.floor(.0104*document.documentElement.clientWidth),f=Math.floor(.0156*document.documentElement.clientWidth),v=Math.floor(.0208*document.documentElement.clientWidth),b=Math.floor(.026*document.documentElement.clientWidth),x=Math.floor(.03*document.documentElement.clientWidth),w=Math.floor(.0104*document.documentElement.clientWidth);let S={height:g,width:m,hoverdistance:b,hoverlabel:{font:{size:y},namelength:-1},hovermode:"x",hovertemplate:"Test",legend:{bgcolor:"#eeeeee",font:{size:p},y:.5},margin:{b:w,t:x},paper_bgcolor:"rgba(0,0,0,0)",title:{font:{size:v},text:"Views By Category"},xaxis:{automargin:!0,fixedrange:!0,tickfont:{size:y},ticks:"outside",title:{font:{size:f},text:"Year"}},yaxis:{automargin:!0,fixedrange:!0,tickfont:{size:y},ticks:"outside",tickprefix:"  ",title:{font:{size:f},text:"Yearly Views"}}},I={scrollZoom:!1,displayModeBar:!1};const E=getDashboardGraphIds("categoryGraphs");let C=E[0],T=E[1],D=E[2],V=E[3],G=E[4],B=E[5],P=E[6],k=E[7],M=JSON.parse(JSON.stringify(r));M[0].groupnorm="percent";let O=JSON.parse(JSON.stringify(S));O.title.text="Views By Category, Normalized",O.yaxis.title.text="Percent Views",O.yaxis.ticksuffix="%";let N=JSON.parse(JSON.stringify(S));N.title.text="Cumulative Views By Category",N.yaxis.title.text="Cumulative Views";let L=JSON.parse(JSON.stringify(n));L[0].groupnorm="percent";let A=JSON.parse(JSON.stringify(N));A.title.text="Cumulative Views By Category, Normalized",A.yaxis.title.text="Percent Cumulative Views",A.yaxis.ticksuffix="%";for(d=0;d<L.length;d++){var z=L[d],$=z.name;z.hovertemplate="%{y:.2f}% of total views: <i>"+$+"</i><extra></extra>"}let W=JSON.parse(JSON.stringify(S));W.title.text="Average Views Per Video By Category",W.yaxis.title.text="Average Views Per Video",W.yaxis.tickformat=",g";let H=JSON.parse(JSON.stringify(s));H[0].groupnorm="percent";let U=JSON.parse(JSON.stringify(W));U.title.text="Average Views Per Video By Category, Normalized",U.yaxis.title.text="Percent Average Views Per Video",U.yaxis.ticksuffix="%";for(d=0;d<H.length;d++){z=H[d],$=z.name;z.hovertemplate="%{y:.2f}%: <i>"+$+"</i><extra></extra>"}let J=JSON.parse(JSON.stringify(S));J.title.text="Cumulative Average Views Per Video By Category",J.yaxis.title.text="Average Views Per Video",J.yaxis.tickformat=",g";let R=JSON.parse(JSON.stringify(i));R[0].groupnorm="percent";let _=JSON.parse(JSON.stringify(J));_.title.text="Cumulative Average Views Per Video By Category, Normalized",_.yaxis.title.text="Percent Average Views Per Video",_.yaxis.ticksuffix="%";for(d=0;d<R.length;d++){z=R[d],$=z.name;z.hovertemplate="%{y:.2f}%: <i>"+$+"</i><extra></extra>"}let F=[[C,r,S],[T,M,O],[D,n,N],[V,L,A],[G,s,W],[B,H,U],[P,i,J],[k,R,_]],q=0;for(d=0;d<F.length;d++){let[e,t,a]=F[d];try{createGraph(e,t,a,I,u,h)}catch(t){displayGraphError(e,t),q++}}return Promise.resolve("Displayed Category Views Area Charts with "+q+" errors")}function displayTopCategoriesGraphOne(e){e=e||lsGet("categoryStats");var t=["SPECIAL CATEGORIES","OTHER","MISC"],a=0;let o=0;for(var r=.8583,s=.9528,n=r*document.documentElement.clientHeight,i=s*document.documentElement.clientWidth,l=Math.floor(.0234*document.documentElement.clientWidth),d=Math.floor(.02*document.documentElement.clientWidth),c=Math.floor(.0125*document.documentElement.clientWidth),u=[],h=[],g=[],m="views",p=.025,y=categoryColors,f=0;f<e.length;f++){let o=e[f],r=o.root;if(r)for(var v=0;v<t.length;v++)o.name.includes(t[v])&&(r=!1);r&&(a+=Math.round(o[m]))}for(f=0;f<e.length;f++){let r=e[f],s=r.root;if(s)for(v=0;v<t.length;v++)r.name.includes(t[v])&&(s=!1);if(s){let e=Math.round(r[m]);e/a<=p?o+=e:(u.push(e),h.push(y[r.shortName].name),g.push(y[r.shortName].color))}}null!=p&&p>0&&(u.push(o),h.push("Other"),g.push("#5fe0ed"));var b={values:u,labels:h,marker:{colors:g},domain:{row:0,column:0},name:"Total Views<br>By Category",title:{text:"Total Views<br>By Category",font:{size:l}},textinfo:"label",textposition:"inside",hoverlabel:{namelength:"-1"},hovertemplate:"%{label}<br>%{value} views<br>%{percent}",sort:!1,type:"pie",rotation:90};a=0,o=0,u=[],h=[],g=[],m="avgViews",p=.025;for(f=0;f<e.length;f++){let o=e[f],r=o.root;if(r)for(v=0;v<t.length;v++)o.name.includes(t[v])&&(r=!1);r&&(a+=Math.round(o[m]))}for(f=0;f<e.length;f++){let r=e[f],s=r.root;if(s)for(v=0;v<t.length;v++)r.name.includes(t[v])&&(s=!1);if(s){let e=Math.round(r[m]);e/a<=p?o+=e:(u.push(e),h.push(y[r.shortName].name),g.push(y[r.shortName].color))}}null!=p&&p>0&&(u.push(o),h.push("Other"),g.push("#5fe0ed"));var x={values:u,labels:h,marker:{colors:g},domain:{row:0,column:1},name:"Average Views Per Video<br>By Category",title:{text:"Average Views Per Video<br>By Category",font:{size:l}},textinfo:"label",textposition:"inside",hoverlabel:{namelength:"-1"},hovertemplate:"%{label}<br>~%{value} views per video<br>%{percent}",sort:!1,type:"pie",rotation:140},w=[x,b],S={height:n,width:i,font:{size:d},automargin:!0,autosize:!0,paper_bgcolor:"rgba(0,0,0,0)",plot_bgcolor:"rgba(0,0,0,0)",legend:{bgcolor:"#eeeeee",font:{size:c},y:.5},grid:{rows:1,columns:2},margin:{b:5,l:5,r:5,t:5}},I={staticPlot:!0,responsive:!0};const E=getDashboardGraphIds("product-categories"),C=E.graphOne,T=getCurrentDashboardTheme("product-categories");"dark"==T&&(S.plot_bgcolor="#222",S.paper_bgcolor="#222",S.font.color="#fff",S.legend.bgcolor="#444",S.legend.font.color="#fff");try{createGraph(C,w,S,I,r,s)}catch(e){displayGraphError(C,e)}}function displayTopCategoriesGraphTwo(e){e=e||lsGet("categoryStats");for(var t=["SPECIAL CATEGORIES","OTHER","MISC"],a=.8583,o=.9528,r=a*document.documentElement.clientHeight,s=o*document.documentElement.clientWidth,n=Math.floor(.0156*document.documentElement.clientWidth),i=Math.floor(.01*document.documentElement.clientWidth),l=Math.floor(.01*document.documentElement.clientWidth),d=Math.floor(.013*document.documentElement.clientWidth),c=[],u=[],h=[],g="views",m=0;m<e.length;m++){let a=e[m],o=a.root;if(o)for(var p=0;p<t.length;p++)a.name.includes(t[p])&&(o=!1);if(o){let e=Math.round(a[g]);h.push({value:e,label:a.shortName})}}h.sort(function(e,t){return e.value>t.value?-1:e.value==t.value?0:1});for(let e=0;e<h.length;e++){const t=h[e];c.push(t.value),u.push(t.label)}var y={x:u,y:c,name:"Total Views<br>By Category",type:"bar",yaxis:"y",offsetgroup:1,hoverlabel:{namelength:"-1"},hovertemplate:"%{label}<br>%{value:,} views"};c=[],u=[],h=[],g="avgViews";for(m=0;m<e.length;m++){let a=e[m],o=a.root;if(o)for(p=0;p<t.length;p++)a.name.includes(t[p])&&(o=!1);if(o){let e=Math.round(a[g]);h.push({value:e,label:a.shortName})}}h.sort(function(e,t){return e.value>t.value?-1:e.value==t.value?0:1});for(let e=0;e<h.length;e++){const t=h[e];c.push(t.value),u.push(t.label)}var f={x:u,y:c,name:"Average Views Per Video<br>By Category",type:"bar",yaxis:"y2",offsetgroup:2,hoverlabel:{namelength:"-1"},hovertemplate:"%{label}<br>~%{value:,} views per video"},v=[y,f],b={height:r,width:s,font:{size:i},paper_bgcolor:"rgba(0,0,0,0)",plot_bgcolor:"rgba(0,0,0,0)",legend:{bgcolor:"#eeeeee",font:{size:l},x:.8},title:{font:{size:n},text:"Product Category Performance"},xaxis:{automargin:!0,fixedrange:!0,title:{font:{size:d},text:"Category"}},yaxis:{automargin:!0,fixedrange:!0,title:{font:{size:d},text:"Total Category Views"}},yaxis2:{automargin:!0,fixedrange:!0,showgrid:!1,overlaying:"y",side:"right",zeroline:!1,title:{font:{size:d},text:"Average Views Per Video"}}};let x={scrollZoom:!1,displayModeBar:!1};const w=getDashboardGraphIds("product-categories"),S=w.graphTwo,I=getCurrentDashboardTheme("product-categories");"dark"==I&&(b.plot_bgcolor="#222",b.paper_bgcolor="#222",b.font.color="#fff",b.legend.bgcolor="#444",b.legend.font.color="#fff");try{createGraph(S,v,b,x,a,o)}catch(e){displayGraphError(S,e)}}function displayTopCategoriesGraphThree(e){e=e||lsGet("categoryStats");var t=["SPECIAL CATEGORIES","OTHER","MISC"];let a=1;e.forEach(e=>{if(e.root){let t=e.strength;t<a&&(a=t)}});var o=.8583,r=.9528,s=o*document.documentElement.clientHeight,n=r*document.documentElement.clientWidth,i=Math.floor(.0125*document.documentElement.clientWidth),l=Math.floor(.01*document.documentElement.clientWidth),d=Math.floor(.01*document.documentElement.clientWidth),c=Math.floor(.013*document.documentElement.clientWidth);let u=[],h=[],g=[],m=[],p=[],y=[],f=categoryColors;for(var v=0;v<e.length;v++){let a=e[v],o=a.root;if(o)for(var b=0;b<t.length;b++)a.name.includes(t[b])&&(o=!1);if(o){let e=Math.round(a.views),t=Math.round(a.avgViews),o=Math.round(100*a.avgStrength),r=a.videos.length,s=a.shortName,n=f[a.shortName].color;u.push(e),h.push(t),g.push(r),m.push(s),p.push(n),y.push({x:[e],y:[r],mode:"markers",type:"scatter",marker:{color:[n],size:[o],sizemode:"area"},customdata:[Math.round(a.avgStrength)],name:s,text:[s],hoverlabel:{namelength:"-1"},hovertemplate:"<b>%{text}</b><br>%{x:,} views<br>%{y} videos<br>Category Strength: %{customdata:,}<extra></extra>"})}}var x={height:s,width:n,font:{size:l},hovermode:"closest",paper_bgcolor:"rgba(0,0,0,0)",plot_bgcolor:"rgba(0,0,0,0)",legend:{bgcolor:"#eeeeee",font:{size:d},y:.5},title:{font:{size:i},text:"<b>Product Category Performance</b><br>Circle Area is proportional to Category Strength"},xaxis:{automargin:!0,fixedrange:!0,gridcolor:"#aaaaaa",title:{font:{size:c},text:"Total Category Views"},type:"log"},yaxis:{automargin:!0,fixedrange:!0,gridcolor:"#888888",title:{font:{size:c},text:"Number of Videos"},type:"log"}};let w={scrollZoom:!1,displayModeBar:!1};const S=getDashboardGraphIds("product-categories"),I=S.graphThree,E=getCurrentDashboardTheme("product-categories");"dark"==E&&(x.plot_bgcolor="#222",x.paper_bgcolor="#222",x.font.color="#fff",x.legend.bgcolor="#444",x.legend.font.color="#fff");try{createGraph(I,y,x,w,o,r)}catch(e){displayGraphError(I,e)}}function displayTopVideoTitles(e){let t={};for(const a in e)if(e.hasOwnProperty(a)){const o=e[a],r=lsGet("statsByVideoId");let s=document.getElementById(o+"-title");s.innerHTML=r[a].title;const n=r[a].duration;document.getElementById(o+"-duration").innerHTML="Duration: "+secondsToDuration(n),document.getElementById(o+"-duration-seconds").innerHTML=n;let i=document.getElementById(o+"-publish-date"),l=r[a].publishDate;const d=l.slice(0,4),c=l.slice(5,7),u=l.slice(8,10);l=c+"/"+u+"/"+d,i.innerHTML="Published: "+l;let h=document.getElementById(o+"-thumbnail"),g="YouTube Video ID: "+a;r&&r[a]&&(g=r[a].title);let m=`\n        <a href="https://youtu.be/${a}" target="_blank"\n            alt="${g}">\n          <img class="top-video-thumbnail" onload="thumbnailCheck($(this), true)"\n              src="https://i.ytimg.com/vi/${a}/maxresdefault.jpg"\n              alt="thumbnail" title="${g}">\n        </a>`;h.innerHTML=m,t[a]={dashboardId:o,title:r[a].title,duration:r[a].duration,publishDate:l,thumbnail:m}}return t}function displayUploadThumbnails(){let e=lsGet("statsByVideoId");var t=document.getElementsByClassName("carousel-inner")[0];if(t.children.thumbnails){let t=lsGet("uploads");if(!t){const e=new Error("Uploads does not exist");throw recordError(e),e}for(var a="",o=0;o<t.length;o++){var r="YouTube Video ID: "+t[o];e&&e[t[o]]&&(r=e[t[o]].title),a+=`\n        <a href="https://youtu.be/${t[o]}" target="_blank"\n            alt="${r}">\n          <img class="thumbnail"\n              src="https://i.ytimg.com/vi/${t[o]}/mqdefault.jpg" \n              alt="thumbnail" title="${r}">\n        </a>`}var s=document.getElementById("thumbnail-container");if(s.innerHTML=a,!autoScrollDivs.includes("thumbnail-wrapper")){let e=lsGet("settings"),t=-1,a=0;for(;-1==t&&a<=e.dashboards.length;){let o=e.dashboards[a];"thumbnails"==o.name&&(t=o.scrollSpeed),a++}t=t<=0?0:Math.ceil(1e3/t),new AutoDivScroll("thumbnail-wrapper",t,1,1),autoScrollDivs.push("thumbnail-wrapper")}}return Promise.resolve("Displayed Upload Thumbnails")}function displayVideoStrengthBars(e,t){const a=lsGet("strengthCalc"),o=a.weights;let r=[],s=[];for(const t in o)if(o.hasOwnProperty(t)){const a=o[t];0!=a&&("avgViewsPerDay"==t?r.push("Average<br>Views<br>Per Day"):"likesPerView"==t?r.push("Likes<br>Per View"):"subscribersGained"==t?r.push("Subscribers<br>Gained"):"avgViewPercentage"==t?r.push("Average<br>View<br>Percentage"):"dislikesPerView"==t?r.push("Dislikes<br>Per View"):r.push(capitalizeFirstLetter(t)),a>0?s.push(e.z[t]):s.push(-1*e.z[t]))}const n=[],i="rgb(50,171,96)",l="rgb(255,0,0)";for(let e=0;e<s.length;e++){const t=s[e];t>=0?n.push(i):n.push(l)}const d=.3673,c=.2864,u=d*document.documentElement.clientHeight,h=c*document.documentElement.clientWidth,g=Math.floor(.0114*document.documentElement.clientWidth),m=Math.floor(.0067*document.documentElement.clientWidth),p=Math.floor(.0093*document.documentElement.clientWidth),y=Math.floor(.0093*document.documentElement.clientWidth),f=g+10,v=[{x:r,y:s,marker:{color:n},type:"bar"}],b={height:u,width:h,hovermode:!1,margin:{b:0,l:0,r:0,t:f},paper_bgcolor:"rgb(255,250,250)",plot_bgcolor:"rgb(255,250,250)",title:{font:{size:g},text:"Contributions to Video Strength"},xaxis:{automargin:!0,fixedrange:!0,tickangle:0,tickfont:{size:m}},yaxis:{automargin:!0,fixedrange:!0,gridcolor:"#aaaaaa",tickprefix:" ",tickfont:{size:p},title:{font:{size:y},text:"Contribution"},zerolinewidth:2}},x={scrollZoom:!1,displayModeBar:!1,staticPlot:!0,responsive:!0};try{createGraph(t,v,b,x,d,c)}catch(e){displayGraphError(t,e)}}function updateCategoryTotals(e){let t=lsGet("statsByVideoId"),a=lsGet("categoryTotals");return e.forEach(e=>{let o=e.videoId,r=e.duration,s=e.views,n=e.likes,i=e.strength;t[o].duration=r;let l=t[o].categories;for(let e=0;e<l.length;e++){let t=l[e];null==a[t]&&(a[t]={},a[t].videos=[]);let d=parseInt(a[t].views),c=parseInt(a[t].likes),u=parseInt(a[t].duration),h=parseFloat(a[t].strength),g=a[t].videos;g.push(o),a[t].views=d+s,a[t].likes=c+n,a[t].duration=u+r,a[t].strength=h+i,a[t].videos=g}}),lsSet("categoryTotals",a),lsSet("statsByVideoId",t),a}function calcCategoryStats(e){let t=[];for(let a in e)if(e.hasOwnProperty(a)){let o=e[a],r=o.shortName,s=o.name,n=o.root,i=o.leaf,l=parseInt(o.views),d=parseInt(o.likes),c=parseInt(o.duration),u=parseFloat(o.strength),h=o.videos,g=h.length,m=l/g,p=d/g,y=c/g,f=u/g;t.push({avgDuration:y,avgLikes:p,avgViews:m,categoryId:a,duration:c,leaf:i,likes:d,name:s,root:n,shortName:r,totalStrength:u,avgStrength:f,videos:h,views:l})}return lsSet("categoryStats",t),t}function createGraph(e,t,a,o,r,s,n){try{Plotly.newPlot(e,t,a,o),recordGraphData(e,t,a,o,r,s,n),recordGraphSize(e,r,s,n)}catch(e){throw e}}function recordGraphData(e,t,a,o,r,s,n){let i=document.querySelectorAll(".graph-container").length,l=lsGet("graphData");l&&(n||(n="None"),l[e]={data:t,layout:a,config:o,graphHeight:r,graphWidth:s,automargin:n},Object.keys(l).length==i?(lsSet("graphData",l),gapi.auth2.getAuthInstance().isSignedIn.get()&&saveGraphDataToSheets()):lsSet("graphData",l))}function recordGraphSize(e,t,a,o){lsGet("graphSizes")||lsGet("graphSizes",{});let r=lsGet("graphSizes");r[e]={height:t,width:a},o&&(r[e].automargin=o),lsSet("graphSizes",r)}function resetGraphData(){lsSet("graphData",{}),lsSet("graphSizes",{})}function resizeGraphs(){const e=lsGet("graphSizes"),t=document.documentElement.clientHeight,a=document.documentElement.clientWidth;for(const o in e)if(e.hasOwnProperty(o)){const r=e[o],s=r.height*t,n=r.width*a,i={height:s,width:n};Plotly.relayout(o,i)}}function swapNormalCharts(){var e=$(".carousel-container.active >>> .carousel-item.active")[0].id,t=e+"-chart",a=document.getElementById(t);a&&("none"==a.style.display?a.style.display="":a.style.display="none")}function swapDashboardGraphs(){const e=$(".carousel-container.active >>> .carousel-item.active")[0].id;let t,a,o;if("product-categories"==e){const r=getDashboardGraphIds(e);t=document.getElementById(r.graphOne),a=document.getElementById(r.graphTwo),o=document.getElementById(r.graphThree)}else if(0==e.indexOf("videographer")){let r;"videographer-avg-views"==e?r=getDashboardGraphIds("videographerGraphs").avgViews:"videographer-cumulative-videos"==e?r=getDashboardGraphIds("videographerGraphs").cumulativeVideos:"videographer-monthly-videos"==e?r=getDashboardGraphIds("videographerGraphs").monthlyVideos:"videographer-cumulative-views"==e?r=getDashboardGraphIds("videographerGraphs").cumulativeViews:"videographer-monthly-views"==e&&(r=getDashboardGraphIds("videographerGraphs").monthlyViews),t=document.getElementById(r.all),a=document.getElementById(r.organic),o=document.getElementById(r.notOrganic)}if(t&&a&&o)""==t.style.display?(t.style.display="none",a.style.display="",o.style.display="none"):""==a.style.display?(t.style.display="none",a.style.display="none",o.style.display=""):""==o.style.display&&(t.style.display="",a.style.display="none",o.style.display="none");else{const t=$(".carousel-container.active")[0].id;if("category-stats-content"==t)swapNormalCharts();else if(0==e.indexOf("vstat")){const t=document.getElementById(e),a=t.querySelector(".vstats-grid-container.active-grid");let o=a.nextElementSibling;if(null==o){const e=a.parentElement;o=e.firstElementChild}a.classList.remove("active-grid"),o.classList.add("active-grid")}}}function displayGraphError(e,t){t&&recordError(t,`Unable to display graph "${e}" - `);let a='\n    <div class="h-100 w-100 position-relative">\n      <div class="alert alert-danger graph-error h3" role="alert">\n        <i class="fas fa-exclamation-triangle"></i>\n        Error loading graph\n      </div>\n    </div>\n  ';const o=document.getElementById(e);o.innerHTML=a}function fixGraphMargins(){let e=lsGet("graphSizes");for(var t in e){let a=e[t].automargin;a&&Plotly.relayout(t,a)}}function updateTheme(e){try{if(gapi.auth2.getAuthInstance().isSignedIn.get()){var t=document.getElementsByClassName("carousel-item")[e],a=document.getElementsByTagName("body")[0];"dark"==t.getAttribute("theme")?(a.className="dark","platform"==t.id&&document.getElementsByClassName("demographics-table")[0].classList.add("table-dark")):a.className=""}}catch(e){console.error(e),recordError(e)}}function getDashboardGraphIds(e){if("categoryGraphs"==e)return currentSettings.categoryGraphs;if("videographerGraphs"==e)return currentSettings.videographerGraphs;if("top-video-"==e.substr(0,10)){let t=/[^-]*$/.exec(e)[0],a=currentSettings.topVideoGraphs,o={};for(const e in a)if(a.hasOwnProperty(e)){const r=a[e];o[e]=r.replace("#",t)}return o}const t=currentSettings.dashboards;let a=0;for(;a<t.length;){const o=t[a];if(o.name==e)return o.graphIds;a++}return null}function carouselNext(){$(".carousel-container.active > .carousel").carousel("next")}function carouselPrev(){$(".carousel-container.active > .carousel").carousel("prev")}function pauseDashboard(){let e=document.getElementById("pause-text"),t=document.getElementById("play-text");$("#dashboard-carousel").carousel("pause"),$("#category-stats-carousel").carousel("pause"),$("#videographer-carousel").carousel("pause"),e.style.display="initial",t.style.display="none",isPaused=!0}function playDashboard(){let e=document.getElementById("pause-text"),t=document.getElementById("play-text");$("#dashboard-carousel").carousel("cycle"),$("#category-stats-carousel").carousel("cycle"),$("#videographer-carousel").carousel("cycle"),e.style.display="none",t.style.display="initial",setTimeout(function(){0!=t.offsetHeight&&$("#play-text").fadeOut()},2e3),isPaused=!1}function toggleDashboardPause(){isPaused?playDashboard():pauseDashboard()}function temporarilyToggleDashboardPause(e){e?($("#dashboard-carousel").carousel("pause"),$("#category-stats-carousel").carousel("pause"),$("#videographer-carousel").carousel("pause")):isPaused||($("#dashboard-carousel").carousel("cycle"),$("#category-stats-carousel").carousel("cycle"),$("#videographer-carousel").carousel("cycle"))}function goToCarouselItem(e){$(".carousel-container.active > .carousel").carousel(e)}function swapCarousels(e){let t=$("#carousel-list"),a=t.children().length,o=$(".carousel-container.active"),r=parseInt(o.attr("carousel")),s=r+e,n=(s%a+a)%a,i=$(`.carousel-container[carousel='${n}']`);pauseDashboard(),o.removeClass("active"),i.addClass("active")}function addDotsToLoadingText(){const e=document.getElementById("loading-text");e.innerHTML.endsWith("...")||(e.innerHTML+="...")}function hideLoadingText(){const e=document.getElementById("loading-text");e.style.display="none"}function showLoadingText(){const e=document.getElementById("loading-text");e.style.display="initial"}function hideUpdatingText(){const e=document.getElementById("updating-text");e.style.display="none"}function showUpdatingText(){const e=document.getElementById("updating-text");e.style.display="initial"}function setLoadingStatus(e){isLoading=e,temporarilyToggleDashboardPause()}function setUpdatingStatus(e){isUpdating=e,temporarilyToggleDashboardPause()}lsGet("settings")||lsSet("settings",defaultSettings);let currentSettings=lsGet("settings");const settingsVersion=currentSettings.version,defaultVersion=defaultSettings.version;(null==settingsVersion||defaultVersion>settingsVersion)&&(lsSet("settings",defaultSettings),currentSettings=defaultSettings);var carouselInner=document.getElementById("main-carousel-inner"),indicatorList=document.getElementById("main-indicator-list");const cycleSpeed=1e3*currentSettings.cycleSpeed;var carousel=document.getElementById("dashboard-carousel");carousel.setAttribute("data-interval",cycleSpeed),carousel.setAttribute("data-pause","false");const categoryStatsCarousel=document.getElementById("category-stats-carousel");categoryStatsCarousel.setAttribute("data-interval",cycleSpeed),categoryStatsCarousel.setAttribute("data-pause","false");const videographerCarousel=document.getElementById("videographer-carousel");videographerCarousel.setAttribute("data-interval",cycleSpeed),videographerCarousel.setAttribute("data-pause","false");for(var enabledOrder=new Array(currentSettings.numEnabled),i=0;i<currentSettings.dashboards.length;i++){var dashboard=currentSettings.dashboards[i];dashboard.index>=0&&enabledOrder.splice(dashboard.index,1,{name:dashboard.name,icon:dashboard.icon,theme:dashboard.theme,title:dashboard.title})}for(i=0;i<enabledOrder.length;i++){var dashboardItem=document.getElementById(enabledOrder[i].name),indicator=document.getElementById("indicator").cloneNode();if(enabledOrder[i].name.includes("top-video-")){dashboardItem=document.getElementById("top-video-#").cloneNode(!0),dashboardText=dashboardItem.outerHTML,dashboardText=dashboardText.replace(/top-video-#/g,enabledOrder[i].name),dashboardText=dashboardText.replace(/TITLE PLACEHOLDER/,enabledOrder[i].title);var template=document.createElement("template");template.innerHTML=dashboardText,dashboardItem=template.content.firstChild}else dashboardItem.remove();document.createElement("div",dashboardItem.outerText),dashboardItem.setAttribute("theme",enabledOrder[i].theme),indicator.id="main-indicator-"+i,indicator.setAttribute("onclick","goToCarouselItem("+i+")"),indicator.className=enabledOrder[i].icon+" indicator",carouselInner.appendChild(dashboardItem),indicatorList.appendChild(indicator),0==i&&(dashboardItem.classList.add("active"),indicator.classList.add("active"))}document.getElementById("top-video-#").remove(),createVideographerStatsDashboards(),document.addEventListener("keyup",function(e){"ArrowLeft"==e.key?carouselPrev():"ArrowRight"==e.key?carouselNext():"ArrowDown"==e.key?swapCarousels(1):"ArrowUp"==e.key?swapCarousels(-1):32==e.which?toggleDashboardPause():"F2"==e.key?signIn():"A"==e.key.toUpperCase()?goToCarouselItem(9):"B"==e.key.toUpperCase()?goToCarouselItem(10):"C"==e.key.toUpperCase()?goToCarouselItem(11):"D"==e.key.toUpperCase()?goToCarouselItem(12):"E"==e.key.toUpperCase()?goToCarouselItem(13):"F"==e.key.toUpperCase()?goToCarouselItem(14):"N"==e.key.toUpperCase()?swapNormalCharts():"R"==e.key.toUpperCase()?reloadVideoStrengthDashboard():"V"==e.key.toUpperCase()?swapDashboardGraphs():isNaN(e.key)||32==e.which?"U"==e.key.toUpperCase()&&e.altKey&&gapi.auth2.getAuthInstance().isSignedIn.get()?updateDashboards():"L"==e.key.toUpperCase()&&e.altKey&&loadDashboards():e.ctrlKey||e.altKey?goToCarouselItem(parseInt(e.key)+9):goToCarouselItem(parseInt(e.key)-1)}),$(".carousel").on("slide.bs.carousel",function(e){var t=e.target.getAttribute("name"),a=t+"-indicator-",o=document.getElementById(a+e.from),r=document.getElementById(a+e.to);o.classList.remove("active"),r.classList.add("active"),window.setTimeout(function(){updateTheme(e.to);let t=document.getElementById("top-ten-thumbnail-wrapper");t.scrollLeft!=t.scrollWidth&&(t.scrollLeft=t.scrollWidth)},250)}),window.addEventListener("resize",function(){retry(resizeGraphs,5,5e3);let e=document.getElementById("top-ten");if(e.classList.contains("active")){let e=document.getElementById("top-ten-thumbnail-container");e.style.display="none",this.window.setTimeout(function(){e.style.display="flex"},500)}},!0);let isLoading=!1,isPaused=!1,isUpdating=!1;